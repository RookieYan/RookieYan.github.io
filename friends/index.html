<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="keywords" content="Grideaé™æ€ä¸ªäººåšå®¢">
<meta name="description" content="ä¸€ä¸ªç™½ç—´">
<meta name="theme-color" content="#000">
<title>é—«ã€‚</title>
<link rel="shortcut icon" href="/favicon.ico?v=1588358014506">
<link rel="stylesheet" href="/styles/main.css">
<link rel="stylesheet" href="/media/css/gemini.css">

<link rel="stylesheet" href="/media/fonts/font-awesome.css">
<link
  href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Rosario:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext"
  rel="stylesheet" type="text/css">

<link href="/media/hljs/styles/androidstudio.css"
  rel="stylesheet">

<script src="/media/hljs/highlight.js"></script>
<script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.0/velocity.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.0/velocity.ui.min.js"></script>

<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>



</head>

<body>
  <div class="head-top-line"></div>
  <div class="header-box">
    
<div class="gemini">
  <header class="header  ">
    <div class="blog-header box-shadow-wrapper bg-color " id="header">
      <div class="nav-toggle" id="nav_toggle">
        <div class="toggle-box">
          <div class="line line-top"></div>
          <div class="line line-center"></div>
          <div class="line line-bottom"></div>
        </div>
      </div>
      <div class="site-meta">       
        <div class="site-title">
          
            <a href="/" class="brand">
              <span>é—«ã€‚</span>
            </a>  
          
        </div>
        
          <p class="subtitle">ç²¾äºå¿ƒï¼Œç®€äºå½¢</p>
        
      </div>
      <nav class="site-nav" id="site_nav">
        <ul id="nav_ul">
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/" target="_self">
                  <i class="fa fa-home"></i> é¦–é¡µ
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/archives/" target="_self">
                  <i class="fa fa-archive"></i> å½’æ¡£
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/tags/" target="_self">
                  <i class="fa fa-tags"></i> æ ‡ç­¾
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/post/about/" target="_self">
                  <i class="fa fa-user"></i> å…³äº
                </a>
              
            </li>
          
          
            
              <li class="nav-item ">
                <a href="/friends/" target="_self">
                  
                    <i class="fa fa-address-book"></i> å‹æƒ…é“¾æ¥
                  
                </a>
              </li>
            
          
        </ul>
      </nav>
    </div>
  </header>
</div>

<script type="text/javascript"> 
 
  let showNav = true;

  let navToggle = document.querySelector('#nav_toggle'),
  siteNav = document.querySelector('#site_nav');
  
  function navClick() {
    let sideBar = document.querySelector('.sidebar');
    let navUl = document.querySelector('#nav_ul');
    navToggle.classList.toggle('nav-toggle-active');
    siteNav.classList.toggle('nav-menu-active');
    if (siteNav.classList.contains('nav-menu-active')) {
      siteNav.style = "height: " + (navUl.children.length * 42) +"px !important";
    } else {
      siteNav.style = "";
    }
  }

  navToggle.addEventListener('click',navClick);  
</script>
  </div>
  <div class="main-continer">
    
    <div
      class="section-layout gemini ">
      <div class="section-layout-wrapper">
        <div id="sidebarMeta" class="sidebar">
    
<div class="sidebar-wrapper box-shadow-wrapper bg-color">
  <div class="sidebar-item">
    <img class="site-author-image right-motion" src="/images/avatar.png"/>
    <p class="site-author-name">é€‚ç”¨ Gemini,Pisces å¸ƒå±€,ç‰ˆæƒè¯´æ˜éœ€é…ç½®</p>
    
  </div>
  <div class="sidebar-item side-item-stat right-motion">
    <div class="sidebar-item-box">
      <a href="/archives/">
        
        <span class="site-item-stat-count">4</span>
        <span class="site-item-stat-name">æ–‡ç« </span>
      </a>
    </div>
    <div class="sidebar-item-box">
      <a href="">
        <span class="site-item-stat-count">0</span>
        <span class="site-item-stat-name">åˆ†ç±»</span>
      </a>
    </div>
    <div class="sidebar-item-box">
      <a href="/tags/">
        <span class="site-item-stat-count">0</span>
        <span class="site-item-stat-name">æ ‡ç­¾</span>
      </a>
    </div>
  </div>
  
    
  
  


</div>
</div>
<script>
  let sidebarMeta = document.querySelector('#sidebarMeta');
  let scheme = 'gemini';
  let sidebarWrapper = document.querySelector('.sidebar-wrapper');
  if (sidebarMeta && (scheme === 'pisces' || scheme === 'gemini')) {
    document.addEventListener('scroll', function(e) {
      if (document.scrollingElement.scrollTop > parseInt(sidebarMeta.style.marginTop) + 10) {
        sidebarWrapper.classList.add('home-sidebar-fixed')
      } else {
        sidebarWrapper.classList.remove('home-sidebar-fixed')
      }
    });
  }
  </script>
        <div class="section-box gemini box-shadow-wrapper">
          <section class="friends-section bg-color slide-down-in">
            <div class="firends-box">
              <h1 class="firends-title" itemprop="name headline">å‹æƒ…é“¾æ¥</h1>
              
              
              
            </div>
            <hr>
            <div style="text-align:center">
              <span class="with-love">
                <i class="fa fa-heart"></i>
              </span>
              ç•™è¨€æ·»åŠ å‹é“¾
              <span class="with-love">
                <i class="fa fa-heart"></i>
              </span>
            </div>
            <hr>
            <div class="friends-note">
              <p><strong>å‹é“¾æ ¼å¼ï¼š</strong></p>
              <ul>
                <li>ç½‘ç«™åç§°ï¼šé—«ã€‚</li>
                <li>ç½‘ç«™åœ°å€ï¼š<a href="https://RookieYan.github.io" data-pjax-state="">https://RookieYan.github.io</a></li>
                <li>ç½‘ç«™æè¿°ï¼šä¸€ä¸ªç™½ç—´</li>
                <li>ç½‘ç«™å¤´åƒï¼š
                  <a href="https://RookieYan.github.io/images/avatar.png">https://RookieYan.github.io/images/avatar.png</a>
                </li>
              </ul>
            </div>
            
  

          </section>
        </div>
      </div>
    </div>
    <div class="footer-box">
  <footer class="footer">
    <div class="copyright">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | Â© 2019-2020 Theme By <a href="https://github.com/hsxyhao/gridea-theme-next" target="_blank">HsxyHao</a>
    </div>
    <div class="poweredby">
      Powered by <a href="https://rookieyan.github.io/" target="_blank">é—«</a>
    </div>
  </footer>
  
  
  <div class="gemini back-to-top" id="back_to_top">
    <i class="fa fa-arrow-up"></i>
    
    <span class="scrollpercent">
      <span id="back_to_top_text">0</span>%
    </span>
    
  </div>
  
    <div class="bg-img">
      <img src="/media/images/1.jpg" />
    </div>
  
  
  
</div>
<script>

  let sideBarOpen = 'sidebar-open';
  let body = document.body;
  let back2Top = document.querySelector('#back_to_top'),
  back2TopText = document.querySelector('#back_to_top_text'),
  drawerBox = document.querySelector('#drawer_box'),
  rightSideBar = document.querySelector('.sidebar'),
  viewport = document.querySelector('body');

  function scrollAnimation(currentY, targetY) {
   
    let needScrollTop = targetY - currentY
    let _currentY = currentY
    setTimeout(() => {
      const dist = Math.ceil(needScrollTop / 10)
      _currentY += dist
      window.scrollTo(_currentY, currentY)
      if (needScrollTop > 10 || needScrollTop < -10) {
        scrollAnimation(_currentY, targetY)
      } else {
        window.scrollTo(_currentY, targetY)
      }
    }, 1)
  }

  back2Top.addEventListener("click", function(e) {
    scrollAnimation(document.scrollingElement.scrollTop, 0);
    e.stopPropagation();
    return false;
  });
  
  window.addEventListener('scroll', function(e) {
    let percent = document.scrollingElement.scrollTop / (document.scrollingElement.scrollHeight - document.scrollingElement.clientHeight) * 100;
    if (percent > 1 && !back2Top.classList.contains('back-top-active')) {
      back2Top.classList.add('back-top-active');
    }
    if (percent == 0) {
      back2Top.classList.remove('back-top-active');
    }
    if (back2TopText) {
      back2TopText.textContent = Math.floor(percent);
    }
  });

  
  let hasCacu = false;
  window.onresize = function() {
    if (window.width > 991) {
      calcuHeight();
    } else {
      hasCacu = false;
    }
  }

  function calcuHeight() {
    // åŠ¨æ€è°ƒæ•´ç«™ç‚¹æ¦‚è§ˆé«˜åº¦
    if (!hasCacu && back2Top.classList.contains('pisces') || back2Top.classList.contains('gemini')) {
      let sideBar = document.querySelector('.sidebar');
      let navUl = document.querySelector('#site_nav');
      sideBar.style = 'margin-top:' + (navUl.offsetHeight + navUl.offsetTop + 15) + 'px;';
      hasCacu = true;
    }
  }
  calcuHeight();
  
  let open = false, MOTION_TIME = 300, RIGHT_MOVE_DIS = '320px';

  if (drawerBox) {
    let rightMotions = document.querySelectorAll('.right-motion');
    let right = drawerBox.classList.contains('right');

    let transitionDir = right ? "transition.slideRightIn" : "transition.slideLeftIn";

    let openProp, closeProp;
    if (right) {
      openProp = {
        paddingRight: RIGHT_MOVE_DIS 
      };
      closeProp = {
        paddingRight: '0px'
      };
    } else {
      openProp = {
        paddingLeft: RIGHT_MOVE_DIS 
      };
      closeProp = {
        paddingLeft: '0px'
      };
    }

    drawerBox.onclick = function() {
      open = !open;
      window.Velocity(rightSideBar, 'stop');
      window.Velocity(viewport, 'stop');
      window.Velocity(rightMotions, 'stop');
      if (open) {
        window.Velocity(rightSideBar, {
          width: RIGHT_MOVE_DIS
        }, {
          duration: MOTION_TIME,
          begin: function() {
            window.Velocity(rightMotions, transitionDir,{ });
          }
        })
        window.Velocity(viewport, openProp,{
          duration: MOTION_TIME
        });
      } else {
        window.Velocity(rightSideBar, {
          width: '0px'
        }, {
          duration: MOTION_TIME,
          begin: function() {
            window.Velocity(rightMotions, {
              opacity: 0
            });
          }
        })
        window.Velocity(viewport, closeProp ,{
          duration: MOTION_TIME
        });
      }
      for (let i = 0; i < drawerBox.children.length; i++) {
        drawerBox.children[i].classList.toggle('muse-line');
      }
      drawerBox.classList.toggle(sideBarOpen);
    }
  }

  // é“¾æ¥è·³è½¬
  let newWindow = 'false'
  if (newWindow === 'true') {
    let links = document.querySelectorAll('.post-body a')
    links.forEach(item => {
      if (!item.classList.contains('btn')) {
        item.setAttribute("target","_blank");
      }
    })
  }
  // ä»£ç é«˜äº®
  hljs.initHighlightingOnLoad();

</script>
  </div>
</body>
<input hidden id="copy" />
<script>
  //æ‹¿æ¥ä¸»ä¹‰(çœŸé¦™)^_^ï¼ŒClipboard å®ç°æ‘˜è‡ªæ˜é‡‘ https://juejin.im/post/5aefeb6e6fb9a07aa43c20af
  window.Clipboard = (function (window, document, navigator) {
    var textArea,
      copy;

    // åˆ¤æ–­æ˜¯ä¸æ˜¯iosç«¯
    function isOS() {
      return navigator.userAgent.match(/ipad|iphone/i);
    }
    //åˆ›å»ºæ–‡æœ¬å…ƒç´ 
    function createTextArea(text) {
      textArea = document.createElement('textArea');
      textArea.value = text;
      textArea.style.width = 0;
      textArea.style.height = 0;
      textArea.clientHeight = 0;
      textArea.clientWidth = 0;
      document.body.appendChild(textArea);
    }
    //é€‰æ‹©å†…å®¹
    function selectText() {
      var range,
        selection;

      if (isOS()) {
        range = document.createRange();
        range.selectNodeContents(textArea);
        selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);
        textArea.setSelectionRange(0, 999999);
      } else {
        textArea.select();
      }
    }

    //å¤åˆ¶åˆ°å‰ªè´´æ¿
    function copyToClipboard() {
      try {
        document.execCommand("Copy")
      } catch (err) {
        alert("å¤åˆ¶é”™è¯¯ï¼è¯·æ‰‹åŠ¨å¤åˆ¶ï¼")
      }
      document.body.removeChild(textArea);
    }

    copy = function (text) {
      createTextArea(text);
      selectText();
      copyToClipboard();
    };

    return {
      copy: copy
    };
  })(window, document, navigator);

  function copyCode(e) {
    if (e.srcElement.tagName === 'SPAN' && e.srcElement.classList.contains('copy-code')) {
      let code = e.currentTarget.querySelector('code');
      var text = code.innerText;
      if (e.srcElement.textContent === 'å¤åˆ¶æˆåŠŸ') {
        console.log('å¤åˆ¶æ“ä½œé¢‘ç‡è¿‡é«˜');
        return;
      }
      e.srcElement.textContent = 'å¤åˆ¶æˆåŠŸ';
      (function (elem) {
        setTimeout(() => {
          if (elem.textContent === 'å¤åˆ¶æˆåŠŸ') {
            elem.textContent = 'å¤åˆ¶ä»£ç '
          }
        }, 1000);
      })(e.srcElement)
      Clipboard.copy(text);
    }
  }

  let pres = document.querySelectorAll('pre');
  pres.forEach(pre => {
    let code = pre.querySelector('code');
    let copyElem = document.createElement('span');
    copyElem.classList.add('copy-code');
    copyElem.textContent = 'å¤åˆ¶ä»£ç ';
    pre.appendChild(copyElem);
    pre.onclick = copyCode
  })
</script>
<script src="/media/js/motion.js"></script>

<script src="https://cdn.jsdelivr.net/gh/cferdinandi/smooth-scroll/dist/smooth-scroll.polyfills.min.js"></script>
<script>
  var scroll = new SmoothScroll('a[href*="#"]', {
    speed: 500
  });
</script>

<!-- <div class="search-mask" id="search_mask">
  <div class="search-box">
    <div class="search-title">
      <i class="fa fa-search"></i>
      <div class="input-box">
        <input type="text" placeholder="æœç´¢">
      </div>
      <i class="fa fa-times-circle"></i>
    </div>
    <div class="result">
      
      <div class="item">
        <a class="result-title" href="https://RookieYan.github.io/post/2020-04-18mysqler-redolog-he-binlog/"" data-c="
          &lt;p&gt;Â Â ä»Šå¤©è¯´ä¸€ä¸‹MySQLçš„ä¸¤ä¸ªæ—¥å¿—æ¨¡å—ï¼Œåˆ†åˆ«æ˜¯BinLogå’ŒRedoLogã€‚&lt;br&gt;
Â Â å¯èƒ½æœ‰çš„ç ”å‘åŒå­¦ä¼šå¬åˆ°DBAåŒäº‹è¯´MySQLå¯ä»¥æ¢å¤åˆ°åŠä¸ªæœˆå†…çš„ä»»æ„ä¸€ç§’çš„çŠ¶æ€ï¼Œåœ¨æƒŠå¥‡çš„åŒæ—¶ï¼Œå¯èƒ½ä¼šå¥½å¥‡æ˜¯æ€ä¹ˆå®ç°çš„ã€‚æˆ‘ä»¬ä»Šå¤©å°±æ¥èŠèŠè¿™ä¸ªäº‹å„¿ã€‚&lt;/p&gt;
&lt;p&gt;Â Â å‡å¦‚æˆ‘ä»¬ç°åœ¨æœ‰ä¸€å¼ è¡¨Tï¼Œåªæœ‰ä¸»é”®Idå’Œä¸€ä¸ªæ•´å‹å­—æ®µ cï¼Œç„¶åç°åœ¨æˆ‘ä»¬è¦å°†Id=2è¿™ä¸€è¡Œçš„å€¼åŠ 1ï¼Œé‚£ä¹ˆSQLè¯­å¥åº”è¯¥è¿™ä¹ˆå†™ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;update T set c=c+1 where ID=2;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Â Â ä»ä¸Šä¸€ç¯‡&lt;a href=&#34;https://rookieyan.github.io/post/2020-04-18mysqlyi-sql-de-zhi-xing-liu-cheng/&#34;&gt;MySQLï¼ˆä¸€ï¼‰SQLçš„æ‰§è¡Œæµç¨‹&lt;/a&gt;æˆ‘ä»¬åŸºæœ¬å¯ä»¥å¾ˆæ˜ç¡®è¿™æ¡æ›´æ–°çš„SQLè¯­å¥çš„æ‰§è¡Œæµç¨‹ä¼šå’ŒæŸ¥è¯¢æµç¨‹ä¸€æ ·æŠŠæ•´ä¸ªæµç¨‹èµ°ä¸€éã€‚å‰é¢æˆ‘ä»¬ä¹Ÿæœ‰è¯´è¿‡ï¼Œåœ¨å¯¹è¡¨åšæ›´æ–°æ“ä½œçš„æ—¶å€™ï¼Œè·Ÿè¿™ä¸ªè¡¨æœ‰å…³çš„æŸ¥è¯¢ç¼“å­˜ä¼šå¤±æ•ˆï¼Œæ‰€ä»¥è¿™æ¡è¯­å¥çš„æ‰§è¡Œä¼šæŠŠè¡¨Tä¸Šçš„æŸ¥è¯¢ç¼“å­˜ä¸­ç»“æœéƒ½æ¸…ç©ºã€‚è¿™ä¹Ÿæ˜¯æˆ‘ä»¬ä¸€èˆ¬ä¸å»ºè®®ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜çš„åŸå› ã€‚&lt;br&gt;
&lt;img src=&#34;https://RookieYan.github.io/post-images/1588350320310.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Â Â æ¥ä¸‹æ¥åˆ†æå™¨ä¼šé€šè¿‡è¯æ³•å’Œè¯­æ³•è§£æçŸ¥é“è¿™æ˜¯ä¸€æ¡æ›´æ–°è¯­å¥ã€‚ä¼˜åŒ–å™¨ä¼šå†³å®šè¦ä½¿ç”¨IDå¯¹åº”çš„ä¸»é”®ç´¢å¼•ã€‚æ‰§è¡Œå™¨è´Ÿè´£å…·ä½“çš„æ‰§è¡Œæ“ä½œï¼Œæ‰¾åˆ°å¯¹åº”çš„è¿™ä¸€è¡Œï¼Œç„¶åæ›´æ–°ã€‚&lt;/p&gt;
&lt;p&gt;Â Â å’ŒæŸ¥è¯¢æµç¨‹ä¸ä¸€æ ·çš„æ˜¯ï¼Œåœ¨æ›´æ–°æµç¨‹ä¸­ï¼Œä¼šæ¶‰åŠåˆ°ä¸¤ä¸ªæ¯”è¾ƒé‡è¦çš„æ—¥å¿—æ¨¡å—ã€‚ä»–ä»¬æ­£æ˜¯æˆ‘ä»¬ä»Šå¤©è¦è®¨è®ºçš„ä¸»è§’ï¼š&lt;strong&gt;redologï¼ˆé‡åšæ—¥å¿—ï¼‰å’Œbinlogï¼ˆå½’æ¡£æ—¥å¿—ï¼‰&lt;/strong&gt;ã€‚ å¦‚æœæ¥è§¦è¿‡MySQLï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªè¯è‚¯å®šæ˜¯ç»•ä¸è¿‡å»çš„ã€‚å¹¶ä¸”è¿™ä¸¤ä¸ªæ—¥å¿—æ¨¡å—åœ¨è®¾è®¡ä¸Šä¹Ÿæœ‰å¾ˆå¤šæœ‰æ„æ€çš„åœ°æ–¹ï¼Œå¯ä»¥å°†è®¾è®¡æ€è·¯è¿ç”¨åˆ°è‡ªå·±å¹³æ—¶çš„è®¾è®¡å’Œå¼€å‘ä¸­ã€‚&lt;/p&gt;
&lt;h2 id=&#34;1-redo-log&#34;&gt;**1. redo log **&lt;/h2&gt;
&lt;p&gt;Â Â æœ‰ä¸€ä¸ªğŸŒ°å¯ä»¥å¾ˆå¥½çš„è§£é‡Šè¿™ä¸ªæ—¥å¿—æ¨¡å—ã€‚ã€Šå­”ä¹™å·±ã€‹é‚£ç¯‡æ–‡ç« ä¸­ï¼Œé…’é¦†è€æ¿æœ‰ä¸€ä¸ªå°é»‘æ¿å’Œä¸€æœ¬è´¦æœ¬ï¼Œä¸“é—¨è®°å½•å®¢äººèµŠè´¦çš„æƒ…å†µã€‚å¦‚æœæœ‰äººè¦èµŠè´¦æˆ–è€…è¿˜è´¦çš„è¯ï¼Œé…’é¦†è€æ¿ä¸€èˆ¬æœ‰ä¸¤ç§åšæ³•ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æŠŠè´¦æœ¬ç¿»å‡ºæ¥ï¼Œæ‰¾åˆ°å®¢äººå¯¹åº”çš„è®°å½•ï¼Œåšæ›´æ–°æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;å…ˆåœ¨å°é»‘æ¿ä¸Šè®°å½•ä¸‹æ¥è¿™æ¬¡çš„å¸ï¼Œç­‰åˆ°æ‰“çƒŠåå†æŠŠè´¦å•ç¿»å‡ºæ¥æ ¸ç®—ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Â Â åœ¨ç”Ÿæ„æ¯”è¾ƒå¿™ç¢Œçš„æƒ…å†µä¸‹ï¼Œé…’é¦†è€æ¿ä¸€å®šä¼šé€‰æ‹©åè€…ï¼Œå› ä¸ºå‰è€…æ˜¯åœ¨å¤ªéº»çƒ¦äº†ï¼Œéœ€è¦ä»è´¦æœ¬ä¸­å‡†ç¡®æ‰¾åˆ°å®¢äººçš„è®°å½•ï¼ˆå¯èƒ½è¿˜æ²¡æœ‰ç´¢å¼•ï¼‰ï¼Œæ•°ç›®æ¯”è¾ƒå¤§çš„è¯å¯èƒ½è¿˜éœ€è¦ç”¨ç®—ç›˜ç®—ä¸€ä¸‹ï¼Œæœ€åå†æŠŠç»“æœå†™åˆ°è´¦æœ¬ä¸Šã€‚å¦‚æœæ¯”è¾ƒå¿™çš„æƒ…å†µä¸‹ã€‚è¿™ç§æ–¹å¼ä¸€å®šæ˜¯ä¸å¯å–çš„ã€‚ ä¸å¦‚å…ˆå†™åœ¨å°é»‘æ¿ä¸Šï¼Œç­‰åˆ°ç©ºé—²çš„æ—¶å€™ï¼Œå†å»æŠŠè´¦ç›®åŒæ­¥åˆ°è´¦æœ¬ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;Â Â åŒæ ·çš„åœ¨MySQLä¸­ä¹Ÿæœ‰ç›¸ä¼¼çš„é—®é¢˜ï¼Œæ¯ä¸€æ¬¡çš„æ›´æ–°æ“ä½œéƒ½éœ€è¦å†™è¿›ç£ç›˜é‡Œï¼Œç„¶åç£ç›˜ä¹Ÿéœ€è¦æ‰¾åˆ°å¯¹åº”çš„è®°å½•åšæ›´æ–°æ“ä½œã€‚æ•´ä¸ªè¿‡ç¨‹çš„IOæˆæœ¬å’ŒæŸ¥æ‰¾æˆæœ¬éƒ½æ˜¯æ¯”è¾ƒé«˜çš„ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒMySQLçš„è®¾è®¡è€…å°±æƒ³åˆ°äº†ç±»ä¼¼äºé…’é¦†è€æ¿è®°è´¦çš„æ€è·¯æ¥æå‡æ•ˆç‡ï¼Œå‡å°‘IOã€‚&lt;/p&gt;
&lt;p&gt;Â Â æ‰€ä»¥å°é»‘æ¿å’Œè´¦å•é…åˆçš„è¿‡ç¨‹ï¼Œå°±æ˜¯MySQLé‡Œç»å¸¸è¯´åˆ°çš„&lt;strong&gt;WALæŠ€æœ¯ï¼ŒWALæŠ€æœ¯çš„å…¨ç§°æ˜¯Write-Ahead Loggingï¼Œå®ƒçš„å…³é”®ç‚¹å°±æ˜¯å…ˆå†™æ—¥å¿—ï¼Œå†å†™ç£ç›˜ï¼Œä¹Ÿå°±æ˜¯å…ˆå†™ç²‰æ¿ï¼Œç­‰ä¸å¿™çš„æ—¶å€™å†å†™è´¦æœ¬ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Â Â å…·ä½“æ¥è¯´å°±æ˜¯ï¼Œå½“æœ‰ä¸€æ¡è®°å½•éœ€è¦è¢«æ›´æ–°çš„æ—¶å€™ï¼ŒInnoDBå¼•æ“å°±ä¼šå…ˆæŠŠè®°å½•ç»™å†™åˆ°redo logä¸­ï¼ˆå°é»‘æ¿ï¼‰ï¼Œå¹¶ä¸”æ›´æ–°å†…å­˜ã€‚ è¿™ä¸ªæ—¶å€™æ›´æ–°å°±ç®—å®Œæˆäº†ã€‚ åŒæ—¶InnoDBä¼šåœ¨æ¯”è¾ƒåˆé€‚çš„æ—¶å€™ï¼ŒæŠŠè¿™ä¸ªæ“ä½œè®°å½•æ›´æ–°åˆ°ç£ç›˜ä¸­ï¼Œè€Œè¿™ä¸ªæ›´æ–°ä¸€èˆ¬ä¼šæ˜¯åœ¨ç³»ç»Ÿæ¯”è¾ƒç©ºé—²çš„æ—¶å€™å»åšçš„ï¼ˆç±»ä¼¼äºè€æ¿æ‰“çƒŠååšçš„äº‹å„¿ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;Â Â å½“ç„¶ä½ å¯èƒ½ä¼šé—®ï¼Œä¼šä¸ä¼šæœ‰ä¸€ç§æƒ…å†µï¼Œå°±æ˜¯ä»Šå¤©ç”Ÿæ„å¤ªå¥½äº†ï¼Œå°é»‘æ¿éƒ½è¢«å†™æ»¡äº†ï¼Œé‚£æ€ä¹ˆåŠå‘¢ï¼Ÿ å¦‚æœæ˜¯è¿™ç§æƒ…å†µçš„è¯ï¼Œé‚£ä¹ˆåªèƒ½è®©è€æ¿åœä¸‹æ‰‹ä¸­çš„æ´»ï¼Œå…ˆå»æŠŠè´¦æœ¬æ›´æ–°äº†ï¼Œç„¶åæ“¦é™¤é»‘æ¿ä¸Šçš„è®°å½•ï¼Œè…¾å‡ºç©ºé—´ï¼Œå†å†™ä¸Šæ–°çš„è®°å½•ã€‚InnoDBçš„redo logæ˜¯å›ºå®šå¤§å°çš„ï¼Œæ¯”å¦‚å¯ä»¥é…ç½®ä¸€ç»„æ˜¯4ä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶å°ä¸º1Gï¼Œé‚£ä¹ˆè¿™å—â€œå°é»‘æ¿â€æ€»å…±å°±å¯ä»¥è®°å½•4Gçš„æ“ä½œè®°å½•ï¼Œä»å¤´å¼€å§‹å†™ï¼Œå†™åˆ°æœ«å°¾å°±å†ä»å¤´å¼€å§‹å†™ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;br&gt;
&lt;img src=&#34;https://RookieYan.github.io/post-images/1588354832158.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Â Â write posæ˜¯å½“å‰è®°å½•çš„ä½ç½®ï¼Œä¸€è¾¹å†™ä¸€è¾¹åç§»ï¼Œå†™åˆ°LogFile3çš„æœ«å°¾å°±åˆ°äº†LogFile0çš„å¼€å¤´ç»§ç»­å†™ï¼Œcheck pointæ˜¯å½“å‰è¦æ“¦é™¤çš„ä½ç½®ï¼Œä¹Ÿæ˜¯ä¸€æ ·è¦å¾€åç§»å¹¶ä¸”å¾ªç¯çš„ï¼Œæ“¦é™¤è®°å½•å‰è¦æŠŠè®°å½•æ›´æ–°åˆ°æ•°æ®æ–‡ä»¶ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;Â Â write pos å’Œ checkpoint ä¹‹é—´çš„ç»¿è‰²éƒ¨åˆ†æ˜¯â€œå°é»‘æ¿â€ä¸Šè¿˜ç©ºç€çš„éƒ¨åˆ†ï¼Œå¯ä»¥ç”¨æ¥è®°å½•æ–°çš„æ“ä½œã€‚å¦‚æœ write pos è¿½ä¸Š checkpointï¼Œè¡¨ç¤ºâ€œå°é»‘æ¿â€æ»¡äº†ï¼Œè¿™æ—¶å€™ä¸èƒ½å†æ‰§è¡Œæ–°çš„æ›´æ–°ï¼Œå¾—åœä¸‹æ¥å…ˆæ“¦æ‰ä¸€äº›è®°å½•ï¼ŒæŠŠ checkpoint æ¨è¿›ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;Â Â è‡³æ­¤ï¼Œæœ‰äº†redologï¼ŒInnoDBå°±å¯ä»¥ä¿è¯æ•°æ®åœ¨å‘ç”Ÿæ•°æ®åº“å¼‚å¸¸é‡å¯çš„æ—¶å€™ï¼Œä¹‹å‰æäº¤çš„æ•°æ®éƒ½ä¸ä¼šä¸¢å¤±ï¼Œè¿™ä¸ªèƒ½åŠ›ç§°ä¸º&lt;strong&gt;crash-safe&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;2-bin-log&#34;&gt;**2. bin log **&lt;/h2&gt;
"> [2020-04-18]MySQLï¼ˆäºŒï¼‰RedoLogå’ŒBinLog</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://RookieYan.github.io/post/2020-04-21k3s-cong-0-da-jian/"" data-c="
          &lt;h2 id=&#34;0-å‡†å¤‡å·¥ä½œ&#34;&gt;&lt;strong&gt;0. å‡†å¤‡å·¥ä½œ&lt;/strong&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;é¦–å…ˆå‡†å¤‡ä¸¤å°ECSï¼ˆæˆ‘ç”¨çš„æ˜¯é˜¿é‡Œäº‘çš„4æ ¸8Gï¼Œä¹°äº†ä¸€ä¸ªå‘¨ï¼Œå‡†å¤‡æä¸€ä¸‹ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;1-ç¯å¢ƒé…ç½®&#34;&gt;&lt;strong&gt;1. ç¯å¢ƒé…ç½®&lt;/strong&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;éœ€è¦Docker 19.03ï¼ˆå¦‚æœä½¿ç”¨è¾ƒä½ç‰ˆæœ¬ï¼Œåˆ™å¯èƒ½ä¼šå‡ºç°K3Sæ— æ³•å¯åŠ¨çš„é—®é¢˜ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;éœ€è¦æŠŠyum åŒ…æ›´æ–°åˆ°æœ€æ–°&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;yum  update
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://RookieYan.github.io/post-images/1587476469607.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
2. å®‰è£…éœ€è¦çš„ä¾èµ–åŒ… yum-utilæä¾›yum-config-manageråŠŸèƒ½ï¼Œå¦å¤–ä¸¤ä¸ªæ˜¯devicemapperé©±åŠ¨ä¾èµ–çš„ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;yum install -y yum-utils  device-mapper-persistent-data  lvm2
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://RookieYan.github.io/post-images/1587476490002.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
3. è®¾ç½®yumæº&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://RookieYan.github.io/post-images/1587476599172.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;å®‰è£…dockerï¼Œå‡ºç°è¾“å…¥çš„ç•Œé¢éƒ½è¾“å…¥y&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;yum install  -y docker-ce
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://RookieYan.github.io/post-images/1587476923202.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
5. å®‰è£…å®ŒæˆæŸ¥çœ‹ç‰ˆæœ¬&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;docker -v
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://RookieYan.github.io/post-images/1587476969274.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
6.å¯åŠ¨ Docker&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/bin/systemctl start docker.service
å¦‚æœä¸å¯åŠ¨docker ä¼šå¯¼è‡´K3Sæ— æ³•æ­£å¸¸å¯åŠ¨
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;2-å®‰è£…k3smaster&#34;&gt;&lt;strong&gt;2. å®‰è£…K3SMaster&lt;/strong&gt;&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;å›½å†…èŠ‚ç‚¹æ¯”è¾ƒå¿«&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;curl -sfL https://docs.rancher.cn/k3s/k3s-install.sh | INSTALL_K3S_MIRROR=cn sh -s - server --docker
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://RookieYan.github.io/post-images/1587477633426.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;ä»ä¸Šé¢çš„å®‰è£…æ—¥å¿—ä¹Ÿå¯ä»¥çœ‹åˆ°kubectlåªæ˜¯ä¸ªè½¯é“¾æ¥ï¼Œè¯¦ç»†å¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;which kubectl

ls -l /usr/local/bin/kubectl
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://RookieYan.github.io/post-images/1587482331193.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
3. ç¡®è®¤ç‰ˆæœ¬ä¿¡æ¯&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl version
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://RookieYan.github.io/post-images/1587482516688.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
4. è·å–èŠ‚ç‚¹ä¿¡æ¯&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl get node -o wide
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://RookieYan.github.io/post-images/1587482618242.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;strong&gt;è¿™ä¸¤æ­¥æ­¥æ˜æ˜¾æ˜¯å­˜åœ¨é—®é¢˜çš„.. æŸ¥äº†ä¸€äº›èµ„æ–™.. æ²¡èƒ½è§£å†³..&lt;br&gt;
æ­£ç¡®çš„æ˜¾ç¤ºåº”è¯¥æ˜¯ï¼š&lt;/strong&gt;&lt;br&gt;
&lt;img src=&#34;https://RookieYan.github.io/post-images/1587482705796.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://RookieYan.github.io/post-images/1587482682298.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å°è¯•äº†å¥½å‡ ç§æ–¹å¼ï¼Œåæ¥é˜´å·®é˜³é”™çš„è§£å†³äº†.. éœ€è¦çŸ¥é“åŸå› ï¼ è§£å†³æ–¹å¼æ˜¯ï¼Œæ— æ„é—´åœ¨å‘½ä»¤è¡Œè¾“å…¥äº†&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;k3s server &amp;amp; 

k3s server stop
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;ä¼¼ä¹æ‰§è¡Œèµ·äº†ä»€ä¹ˆä¸œè¥¿.. å†ä½¿ç”¨ä¸Šé¢çš„å‘½ä»¤ï¼Œå°±å¯ä»¥çœ‹åˆ°masteræ­£å¸¸å¯åŠ¨äº†..&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ‰¾åˆ°äº†åŸå› æ˜¯å› ä¸º å®‰è£…K3Sä¹‹å‰æœªå¯åŠ¨Docker!!!!&lt;/strong&gt;&lt;br&gt;
5. æŸ¥çœ‹K3SçŠ¶æ€&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/bin/systemctl status k3s
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;3-nodeèŠ‚ç‚¹ç™»å½•&#34;&gt;&lt;strong&gt;3. NodeèŠ‚ç‚¹ç™»å½•&lt;/strong&gt;&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;K3S_TOKENæ˜¯serverç«¯çš„ï¼Œä½äº/var/lib/rancher/k3s/server/node-tokenä¸‹&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;cat /var/lib/rancher/k3s/server/node-token
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://RookieYan.github.io/post-images/1587484770708.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
2. åœ¨agentèŠ‚ç‚¹ä¸Šå®‰è£… å¹¶ä¸”æ·»åŠ åˆ°masterä¸­&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;curl -sfL https://docs.rancher.cn/k3s/k3s-install.sh | INSTALL_K3S_MIRROR=cn K3S_URL=https://172.26.XXX.14:6443 K3S_TOKEN=K102edd25b832c1442cffc113ba1dc78cbf1f26921f8481bee022b8a::server:bf20ed594c877be17d03a840 sh -s - --docker

å¦‚æœå¡«å†™çš„æ˜¯å…¬ç½‘IP åˆ™éœ€è¦å»é˜¿é‡Œæ·»åŠ å®‰å…¨ç»„ å¼€æ”¾6443ç«¯å£
å¦‚æœæ˜¯å†…ç½‘åˆ™ä¸éœ€è¦åšç›¸å…³æ“ä½œ
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ æ£€æŸ¥çŠ¶æ€&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;/bin/systemctl status k3s-agent
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;4-éœ€è¦å®‰è£…mavenå’ŒgitåŒæ—¶æŠŠä»£ç pullä¸‹æ¥&#34;&gt;&lt;strong&gt;4.  éœ€è¦å®‰è£…mavenå’ŒGitåŒæ—¶æŠŠä»£ç pullä¸‹æ¥&lt;/strong&gt;&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;å®‰è£…JDK&lt;br&gt;
https://blog.csdn.net/qq_42670220/article/details/90753244&lt;br&gt;
å®‰è£…rzï¼ˆæ–¹ä¾¿æœ¬åœ°åŒ…ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;yum install -y lrzsz 

å®‰è£…å®Œéœ€è¦åˆ·æ–°é…ç½®
source /etc/profile
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;å®‰è£…Maven&lt;br&gt;
https://www.cnblogs.com/cannel/p/11104190.html&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;vim /etc/profile
source /etc/profile
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;å®‰è£…Git&lt;br&gt;
https://www.cnblogs.com/wulixia/p/11016684.html&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨Git æŠŠä»£ç pullä¸‹æ¥&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;è¿™é‡Œéœ€è¦å…ˆé…ç½®ç§é’¥
ssh-keygen -o

cat cat /root/.ssh/id_rsa.pub

é…ç½®åˆ°gitblitä¸Š

git clone -b devops ssh://yanjianxun@47.93.249.207:29418/~admin/cloud-data-center.git
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;ç¼–å†™ Dockerfile&lt;br&gt;
è·Ÿpom.xmlåŒçº§ç›®å½•ï¼Œ åé¢ä¼šå†™shellè„šæœ¬ï¼Œ è¿™é‡Œçš„Dockerfile å¯èƒ½æ²¡ç”¨äº†ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;FROM java:8-jdk-alpine
LABEL maintainer sunzhe/www.sunzhe.com
RUN apk upgrade
RUN  apk add -U  tzdata &amp;amp;&amp;amp; \
      ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
COPY ./target/cloud-data-center.jar ./
EXPOSE 12313
CMD java -jar /cloud-data-center.jar &amp;gt; cloud-portal.log.out 2&amp;gt;&amp;amp;1
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;6&#34;&gt;
&lt;li&gt;æ‰§è¡ŒDockerfile&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;docker build -f Dockerfile -t haimanyun/cloud-data-center:1.0.0 .
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;7&#34;&gt;
&lt;li&gt;ç¼–å†™è„šæœ¬&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;5-å®‰è£…harbor&#34;&gt;&lt;strong&gt;5.  å®‰è£…harbor&lt;/strong&gt;&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;ä¸‹è½½ï¼Œè§£å‹ (å¦‚æœè‡ªå®¶ç½‘ç»œå¥½ï¼Œå¯ä»¥ä¸‹è½½ä¸‹æ¥å†ä¸Šä¼ åˆ°æœåŠ¡å™¨)&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;wget https://github.com/goharbor/harbor/releases/download/v1.10.2/harbor-offline-installer-v1.10.2.tgz

tar  -zxf  harbor-offline-installer-v1.10.2.tgz
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;ä¿®æ”¹é…ç½®&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;ä¿®æ”¹ harbor.yml -&amp;gt; hostname:æ”¹ä¸ºæœ¬æœºipï¼Œ ä¿®æ”¹http:port,  æ³¨é‡Šæ‰å…³äº httpsçš„é…ç½®ï¼Œä¿®æ”¹å¯†ç 
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;å®‰è£…docker-compose&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;yum -y install docker-compose
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;ä¿®æ”¹dockeré…ç½®&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;systemctl status docker  æ‰¾åˆ°dockerè·¯å¾„

docker.service ä¸­æ·»åŠ é…ç½® -&amp;gt; vim /usr/lib/systemd/system/docker.service 
        ä¸­ ExecStart= åé¢æ·»åŠ ä¸Š --insecure-registry=39.101.174.47:5656
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://RookieYan.github.io/post-images/1587667006811.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
5.  é‡å¯docker&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;systemctl daemon-reload
systemctl restart docker
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;6&#34;&gt;
&lt;li&gt;æ‰§è¡Œharborçš„å®‰è£…è„šæœ¬ï¼Œå¯åŠ¨harbor&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;sh install.sh
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;7&#34;&gt;
&lt;li&gt;ç™»å½•harbor&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;docker login ip:port ç”¨æˆ·åé»˜è®¤ä¸ºadmin å¯†ç ä¸ºè‡ªå·±ä¿®æ”¹é…ç½®æ–‡ä»¶è®¾ç½®å¥½çš„
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;6-ç¼–å†™è„šæœ¬æ–‡ä»¶mavenæ‰“åŒ…dockeråˆ¶ä½œé•œåƒä¾èµ–çš„æ˜¯ç›®å½•ä¸‹çš„dockerfile&#34;&gt;&lt;strong&gt;6.  ç¼–å†™è„šæœ¬æ–‡ä»¶ï¼Œmavenæ‰“åŒ…+dockeråˆ¶ä½œé•œåƒï¼ˆä¾èµ–çš„æ˜¯ç›®å½•ä¸‹çš„Dockerfileï¼‰&lt;/strong&gt;&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Dockerfile&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;FROM java:8-jdk-alpine
LABEL ceshi/www.ceshi.com
RUN apk upgrade
RUN  apk add -U  tzdata &amp;amp;&amp;amp; \
      ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
COPY ./target/cloud-data-center.jar ./
EXPOSE 12313
CMD java -jar /cloud-data-center.jar &amp;gt; cloud-portal.log.out 2&amp;gt;&amp;amp;1
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;é…ç½®æ–‡ä»¶&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;cloud-data-center.yaml&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;---
apiVersion: apps/v1
kind: Deployment 
metadata:
  name: cloud-data-center
  namespace: kube-system 
spec:
  replicas: 1
  selector:
    matchLabels:
      project: kube-system
      app: cloud-data-center
  template:
    metadata:
      labels:
        project: kube-system 
        app: cloud-data-center
    spec:
      imagePullSecrets:
      - name: registry-pull-secret
      containers:
      - name: cloud-data-center
        image: 39.101.204.17:5656/k3s/cloud-data-center:2020-04-24-02-20-49
        imagePullPolicy: Always
        ports:
          - protocol: TCP
            containerPort: 12313
        env:
          - name: JAVA_OPTS
            value: &amp;quot;-Xmx1G&amp;quot;
        resources:
          requests:
            cpu: 0.1
            memory: 128Mi
          limits:
            cpu: 0.1
            memory: 1Gi
        readinessProbe:
          tcpSocket:
            port: 12313
          initialDelaySeconds: 60
          periodSeconds: 10
        livenessProbe:
          tcpSocket:
            port: 12313
          initialDelaySeconds: 60
          periodSeconds: 10
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;é…ç½®æ–‡ä»¶&lt;br&gt;
å¯ä»¥å…ˆæ‰§è¡Œï¼Œ æ‰§è¡Œæ–¹å¼ä¸º kubectl apply -f cloud-data-center-ser.yaml&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: v1
kind: Service
metadata:
  name: cloud-data-center
  namespace: kube-system
spec:
  type: NodePort
  ports:
  - port: 12313
    name: cloud-data-center
  selector:
    project: kube-system
    app: cloud-data-center
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;è„šæœ¬&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;#!/bin/bash
docker_registry=39.101.174.47:5656
kubectl create secret docker-registry registry-pull-secret --docker-server=$docker_registry --docker-username=ceshi --docker-password=Cheshi123456 --docker-email=ceshi@123.com -n kube-system
#service_list=&amp;quot;cloud-data-center&amp;quot;
#service_list=${1:-${service_list}}
service=&amp;quot;cloud-data-center&amp;quot;
current_dir=$(pwd)
cd /data/code/cloud-data-center/cloud-data-center
echo ${current_dir}
# git checkout devops
# -b devops ssh://yanjianxun@47.93.249.207:29418/~admin/cloud-data-center.git
git pull
mvn -f XX/XX/pom.xml clean
mvn -f XX/XX/pom.xml install
image_name=$docker_registry/k3s/${service}:$(date +%F-%H-%M-%S)
sudo docker build -t ${image_name} .
sudo docker push ${image_name}
echo ${current_dir}
sed -i -r &amp;quot;s#(image: )(.*)#\1$image_name#&amp;quot; ${current_dir}/${service}/${service}.yaml
kubectl apply -f ${current_dir}/${service}/${service}.yaml
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;7-å®‰è£…k8s&#34;&gt;&lt;strong&gt;7.  å®‰è£…K8S&lt;/strong&gt;&lt;/h2&gt;
">[2020-04-21]K3Sä»0æ­å»ºä»¥åŠé›†æˆJenkinsCICDæµç¨‹</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://RookieYan.github.io/post/2020-04-18mysqlyi-sql-de-zhi-xing-liu-cheng/"" data-c="
          &lt;p&gt;Â Â ä¹‹å‰çš„ç”±äºä¸å°å¿ƒæŠŠæ‰€æœ‰çš„åšå®¢éƒ½åˆ äº†ï¼Œæ‰€ä»¥ä»0å¼€å§‹é‡æ–°å†™å§ã€‚å› ä¸ºæœ€è¿‘åœ¨çœ‹MySQLå’ŒMongoDBç›¸å…³çš„ï¼Œè¿™ç¯‡å°±å…ˆä»MySQLå¼€å§‹äº†.. åç»­ä¼šç»§ç»­è¡¥ä¸ŠMongoDBçš„å†…å®¹..&lt;br&gt;
Â Â è¿™ç¯‡ä¸»è¦æ˜¯è®²ä¸€ä¸‹MySQLçš„åŸºç¡€.. åŒ…æ‹¬è¯­å¥çš„æ‰§è¡Œæµç¨‹..&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://RookieYan.github.io/post-images/1587222171337.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Â Â é¦–å…ˆç®€å•ä»‹ç»ä¸€ä¸‹MySQLçš„åŸºç¡€ç»“æ„å›¾ï¼Œå¯ä»¥ä»è¿™å¼ å›¾æ¸…æ¥šçš„çœ‹å‡ºä¸€æ¡è¯­å¥åœ¨MySQLçš„å„ä¸ªåŠŸèƒ½æ¨¡å—ä¸­çš„æ‰§è¡Œè¿‡ç¨‹ã€‚&lt;br&gt;
Â Â å¤§ä½“æ¥è¯´MySQL å¯ä»¥åˆ†ä¸º&lt;strong&gt;Serverå±‚&lt;/strong&gt; å’Œ &lt;strong&gt;å­˜å‚¨å¼•æ“å±‚&lt;/strong&gt;ä¸¤éƒ¨åˆ†ã€‚&lt;br&gt;
Â Â Serverå±‚åŒ…å«äº†è¿æ¥å™¨ï¼Œåˆ†æå™¨ï¼Œä¼˜åŒ–å™¨ï¼Œæ‰§è¡Œå™¨ç­‰.. æ¶µç›–äº†å¤§éƒ¨åˆ†MySQLçš„æ ¸å¿ƒåŠŸèƒ½ï¼Œä¸€çº§æ‰€æœ‰çš„å†…ç½®å‡½æ•°ï¼ˆæ¯”å¦‚æ—¶é—´ï¼Œæ—¥æœŸï¼Œæ•°å­¦å’ŒåŠ å¯†å‡½æ•°ç­‰ï¼‰ï¼Œæ‰€æœ‰è·¨å­˜å‚¨å¼•æ“çš„åŠŸèƒ½éƒ½åœ¨è¿™ä¸€å±‚ä¸­ï¼Œæ¯”å¦‚å­˜å‚¨è¿‡ç¨‹ï¼Œè§¦å‘å™¨ï¼Œè§†å›¾ç­‰ç­‰..&lt;/p&gt;
&lt;p&gt;Â Â å­˜å‚¨å¼•æ“å±‚åˆ™è´Ÿè´£æ•°æ®çš„å­˜å‚¨å’Œæå–ã€‚ä»–çš„æ¶æ„æ¨¡å¼æ˜¯æ’ä»¶å¼çš„ï¼Œæ”¯æŒå¤šç§ä¸åŒçš„æ•°æ®åº“å­˜å‚¨å¼•æ“ï¼Œæ¯”å¦‚InnoDBï¼ŒMyISAMï¼ŒMemoryç­‰.. ç°åœ¨æ¯”è¾ƒå¸¸ç”¨çš„æ˜¯InnoDBï¼Œåœ¨MySQL5.5.5å¼€å§‹æˆä¸ºäº†MySQLé»˜è®¤çš„å­˜å‚¨å¼•æ“ã€‚&lt;/p&gt;
&lt;p&gt;Â Â ä¹Ÿå°±æ˜¯è¯´ä½ æ¯æ¬¡åœ¨åˆ›å»ºè¡¨çš„æ—¶å€™ï¼Œå¦‚æœä¸æŒ‡å®šå­˜å‚¨å¼•æ“ï¼Œå°±ä¼šé»˜è®¤ä½¿ç”¨InnoDBå­˜å‚¨å¼•æ“ã€‚å½“ç„¶ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ä½¿ç”¨åˆ«çš„å­˜å‚¨å¼•æ“ï¼Œæ¯”å¦‚åœ¨ create table è¯­å¥ä¸­ä½¿ç”¨ engine=memory æ¥æŒ‡å®šå­˜å‚¨å¼•æ“åˆ›å»ºè¡¨ã€‚&lt;strong&gt;ä¸åŒçš„å­˜å‚¨å¼•æ“å¯¹äºæ•°æ®çš„å­˜å–æ–¹å¼ä¹Ÿä¸ç›¸åŒï¼Œæ”¯æŒçš„åŠŸèƒ½ä¹Ÿä¸ç›¸åŒï¼Œåœ¨åé¢æˆ‘ä»¬ä¼šè¯´ä¸€ä¸‹å…³äºä¸åŒåœºæ™¯ä¸‹ä¸åŒå­˜å‚¨å¼•æ“çš„é€‰æ‹©ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥ä»‹ç»ä¸€ä¸‹Serverå±‚çš„å„ä¸ªç»„ä»¶ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è¿æ¥å™¨&#34;&gt;&lt;strong&gt;è¿æ¥å™¨&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;Â Â æ¯æ¬¡æˆ‘ä»¬è¾“å…¥è´¦å·å¯†ç å’ŒMySQLè¦å»ºç«‹è¿æ¥çš„æ—¶å€™ï¼Œæ¥å¾…æˆ‘ä»¬çš„å°±æ˜¯&lt;strong&gt;è¿æ¥å™¨&lt;/strong&gt;ï¼Œä»–è´Ÿè´£è·Ÿå®¢æˆ·ç«¯å»ºç«‹è¿æ¥ï¼Œè·å–æƒé™ä¿¡æ¯ï¼Œç»´æŒå’Œç®¡ç†è¿æ¥ã€‚ä¸€èˆ¬çš„è¿æ¥å‘½ä»¤&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql -h$ip -P$port -u$user -p
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœç”¨æˆ·åæˆ–å¯†ç ä¸å¯¹ï¼Œä½ å°±ä¼šæ”¶åˆ°ä¸€ä¸ª&amp;quot;Access denied for user&amp;quot;çš„é”™è¯¯ï¼Œç„¶åå®¢æˆ·ç«¯ç¨‹åºç»“æŸæ‰§è¡Œã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœç”¨æˆ·åå¯†ç è®¤è¯é€šè¿‡ï¼Œè¿æ¥å™¨ä¼šåˆ°æƒé™è¡¨é‡Œé¢æŸ¥å‡ºä½ æ‹¥æœ‰çš„æƒé™ã€‚ä¹‹åï¼Œè¿™ä¸ªè¿æ¥é‡Œé¢çš„æƒé™åˆ¤æ–­é€»è¾‘ï¼Œéƒ½å°†ä¾èµ–äºæ­¤æ—¶è¯»åˆ°çš„æƒé™ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;è¿™æ ·ä¹Ÿå°±æ„å‘³ç€ï¼Œåªè¦ä¸€ä¸ªå®¢æˆ·é€šè¿‡è¿æ¥å™¨å»ºç«‹äº†ä¸MySQLçš„è¿æ¥ï¼Œ
å†å»å¯¹è¿™ä¸ªå®¢æˆ·å¸å·è¿›è¡Œæƒé™ä¸Šçš„æ“ä½œï¼Œéƒ½ä¸ä¼šå³æ—¶ç”Ÿæ•ˆï¼Œ
åªèƒ½ç­‰åˆ°è¿™æ¬¡è¿æ¥ç»“æŸï¼Œä¸‹æ¬¡å†å»ºç«‹è¿æ¥çš„æ—¶å€™æ‰ä¼šç”Ÿæ•ˆã€‚
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Â Â å¦‚æœå»ºç«‹å®Œè¿æ¥æ²¡æœ‰åç»­æ“ä½œçš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ªè¿æ¥å°±ä¼šå¤„äºç©ºé—²çš„çŠ¶æ€ï¼Œä½ å¯ä»¥åœ¨ show processlist å‘½ä»¤ä¸­çœ‹åˆ°å®ƒã€‚æ–‡æœ¬ä¸­è¿™ä¸ªå›¾æ˜¯ show processlist çš„ç»“æœï¼Œå…¶ä¸­çš„ Command åˆ—æ˜¾ç¤ºä¸ºâ€œSleepâ€çš„è¿™ä¸€è¡Œï¼Œå°±è¡¨ç¤ºç°åœ¨ç³»ç»Ÿé‡Œé¢æœ‰ä¸€ä¸ªç©ºé—²è¿æ¥ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://RookieYan.github.io/post-images/1587223843571.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Â Â å®¢æˆ·ç«¯å¦‚æœå¤ªé•¿æ—¶é—´æ²¡æœ‰åŠ¨é™ï¼Œè¿æ¥å™¨å°±ä¼šè‡ªåŠ¨æ–­å¼€å®ƒã€‚ è¿™ä¸ªå‚æ•°ä¸»è¦æ˜¯ç”±&lt;strong&gt;wait_timeout&lt;/strong&gt;æ§åˆ¶çš„ï¼Œé»˜è®¤å€¼æ˜¯ 8 å°æ—¶ã€‚&lt;br&gt;
Â Â è€Œå¦‚æœæ°å¥½åœ¨è¿æ¥æ–­å¼€ä¹‹åï¼Œå®¢æˆ·ç«¯å†æ¬¡å‘é€è¯·æ±‚çš„è¯ï¼Œå°±ä¼šæ”¶åˆ°é”™è¯¯æé†’ Lost connection to MySQL server during queryã€‚è¿™æ—¶å€™å¦‚æœä½ è¦ç»§ç»­ï¼Œå°±éœ€è¦é‡è¿ï¼Œç„¶åå†æ‰§è¡Œè¯·æ±‚äº†ã€‚&lt;/p&gt;
&lt;p&gt;Â Â  åœ¨æ•°æ®åº“ä¸­ï¼Œå®¢æˆ·ç«¯ä¸æ•°æ®åº“å»ºç«‹è¿æ¥çš„è¿‡ç¨‹æ˜¯ååˆ†å¤æ‚ä¸”æ¶ˆè€—èµ„æºçš„ï¼Œæ‰€ä»¥å»ºè®®ä½¿ç”¨é•¿é“¾æ¥ï¼ˆ&lt;strong&gt;é•¿é“¾æ¥æ˜¯æŒ‡å¦‚æœåœ¨å®¢æˆ·ç«¯ä¸æ•°æ®åº“è¿æ¥æˆåŠŸåï¼Œå¦‚æœå®¢æˆ·ç«¯æŒç»­æœ‰è¯·æ±‚è¿›æ¥ï¼Œé‚£ä¹ˆä¼šç»§ç»­ä½¿ç”¨å½“å‰å·²ç»å»ºç«‹å¥½çš„è¿™ä¸ªè¿æ¥ã€‚ è€ŒçŸ­è¿æ¥ä¸»è¦æ˜¯æŒ‡ï¼Œåœ¨æ¯æ¬¡æ‰§è¡Œå®Œå¾ˆå°‘çš„å‡ æ¬¡æ“ä½œåï¼Œå°±è‡ªåŠ¨æ–­å¼€è¿æ¥ï¼Œå¦‚æœå†æœ‰æ–°çš„è¯·æ±‚ï¼Œå°±é‡æ–°å»ºç«‹è¿æ¥ã€‚ è¿™æ ·æ¯”è¾ƒæ¶ˆè€—èµ„æº&lt;/strong&gt;ï¼‰ï¼Œ ä½†æ˜¯å¦‚æœå…¨éƒ¨ä½¿ç”¨é•¿è¿æ¥ä¹‹åä¼šå‘ç°æ•°æ®åº“å†…å­˜å ç”¨ä¼šæ¶¨çš„é£å¿«ï¼Œè¿™æ˜¯å› ä¸ºMySQLåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œä¸´æ—¶ä½¿ç”¨çš„å†…å­˜æ˜¯ç®¡ç†åœ¨è¿æ¥å¯¹è±¡é‡Œé¢çš„ã€‚è¿™äº›èµ„æºä¼šåœ¨è¿æ¥æ–­å¼€çš„æ—¶å€™æ‰ä¼šé‡Šæ”¾ã€‚æ‰€ä»¥é•¿è¿æ¥ç§¯ç´¯ä¸‹æ¥å°±ä¼šå¯¼è‡´å†…å­˜å ç”¨ç‡ç‰¹åˆ«é«˜ï¼Œè¢«ç³»ç»Ÿå¼ºè¡Œå¹²æ‰ï¼ˆOOMï¼‰ï¼Œä»ç°è±¡ä¸Šçœ‹å°±åƒæ˜¯MySQLå¼‚å¸¸é‡å¯äº†ã€‚&lt;/p&gt;
&lt;p&gt;æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿä½ å¯ä»¥è€ƒè™‘ä»¥ä¸‹ä¸¤ç§æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å®šæœŸæ–­å¼€é•¿è¿æ¥ã€‚ä½¿ç”¨ä¸€æ®µæ—¶é—´ï¼Œæˆ–è€…ç¨‹åºé‡Œé¢åˆ¤æ–­æ‰§è¡Œè¿‡ä¸€ä¸ªå ç”¨å†…å­˜çš„å¤§æŸ¥è¯¢åï¼Œæ–­å¼€è¿æ¥ï¼Œä¹‹åè¦æŸ¥è¯¢å†é‡è¿ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœä½ ç”¨çš„æ˜¯ MySQL 5.7 æˆ–æ›´æ–°ç‰ˆæœ¬ï¼Œå¯ä»¥åœ¨æ¯æ¬¡æ‰§è¡Œä¸€ä¸ªæ¯”è¾ƒå¤§çš„æ“ä½œåï¼Œé€šè¿‡æ‰§è¡Œ mysql_reset_connection æ¥é‡æ–°åˆå§‹åŒ–è¿æ¥èµ„æºã€‚è¿™ä¸ªè¿‡ç¨‹ä¸éœ€è¦é‡è¿å’Œé‡æ–°åšæƒé™éªŒè¯ï¼Œä½†æ˜¯ä¼šå°†è¿æ¥æ¢å¤åˆ°åˆšåˆšåˆ›å»ºå®Œæ—¶çš„çŠ¶æ€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æŸ¥è¯¢ç¼“å­˜&#34;&gt;&lt;strong&gt;æŸ¥è¯¢ç¼“å­˜&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;Â Â  åœ¨é€šè¿‡è¿æ¥å™¨åˆ›å»ºå®Œè¿æ¥ä¹‹åï¼Œå°±è¦æ‰§è¡ŒSQLå‘½ä»¤äº†ï¼Œæ¯”å¦‚ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ï¼Œè¿™ä¸ªæ—¶å€™æ‰§è¡Œé€»è¾‘å°±ä¼šæ¥åˆ°ç¬¬äºŒæ­¥ï¼ŒæŸ¥è¯¢ç¼“å­˜ã€‚&lt;/p&gt;
&lt;p&gt;Â Â  MySQLæ‹¿åˆ°ä¸€ä¸ªæŸ¥è¯¢è¯·æ±‚åï¼Œä¼šå…ˆåˆ°æŸ¥è¯¢ç¼“å­˜çœ‹ä¸€ä¸‹ï¼Œä¹‹å‰æ˜¯å¦æ‰§è¡Œè¿‡è¿™æ¡è¯­å¥ã€‚ ä¹‹å‰æŸ¥è¯¢è¿‡çš„ä¼šä»¥key-valueå¯¹çš„å½¢å¼ï¼Œè¢«ç›´æ¥ç¼“å­˜åœ¨å†…å­˜ä¸­ã€‚keyæ˜¯æŸ¥è¯¢è¯­å¥ï¼Œvalueæ˜¯æŸ¥è¯¢ç»“æœã€‚ å¦‚æœèƒ½å¤Ÿåœ¨ç¼“å­˜ä¸­æ‰¾åˆ°è¿™ä¸ªkeyï¼Œé‚£ä¹ˆè¿™ä¸ªvalueå°±ä¼šç›´æ¥è¿”å›ç»™å®¢æˆ·ç«¯ã€‚&lt;/p&gt;
&lt;p&gt;Â Â  å¦‚æœè¯­å¥ä¸åœ¨æŸ¥è¯¢ç¼“å­˜ä¸­ï¼Œå°±ä¼šç»§ç»­åé¢çš„æ‰§è¡Œé˜¶æ®µï¼Œè¿›è¡ŒæŸ¥è¯¢ã€‚æŸ¥è¯¢å®Œæˆåæ‰§è¡Œç»“æœå°±ä¼šè¢«å­˜å‚¨åˆ°æŸ¥è¯¢ç¼“å­˜ä¸­ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœå‘½ä¸­æŸ¥è¯¢ç¼“å­˜ï¼ŒMySQLä¸éœ€è¦æ‰§è¡Œåé¢çš„å¤æ‚æ“ä½œï¼Œå°±å¯ä»¥ç›´æ¥è¿”å›ç»“æœï¼Œè¿™ä¸ªæ•ˆç‡ä¼šå¾ˆé«˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä½†æ˜¯åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ˜¯ä¸å»ºè®®ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜çš„ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºæŸ¥è¯¢ç¼“å­˜ç½‘å¾€å¼Šå¤§äºåˆ©ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Â Â  ä¸»è¦åŸå› æ˜¯å› ä¸ºæŸ¥è¯¢ç¼“å­˜å¤±æ•ˆçš„æ¦‚ç‡éå¸¸å¤§ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºæ¯æ¬¡åªè¦å¯¹æŸä¸€å¼ è¡¨æœ‰æ›´æ–°æ“ä½œï¼Œè¿™ä¸ªè¡¨ä¸Šæ‰€æœ‰çš„æŸ¥è¯¢ç¼“å­˜éƒ½ä¼šè¢«æ¸…ç©ºã€‚ å› æ­¤å¯èƒ½ä½ è´¹åŠ²æŠŠç»“æœå­˜èµ·æ¥ä¹‹åï¼Œè¿˜æ²¡æœ‰ç”¨å‘¢ï¼Œä¸€ä¸ªæ›´æ–°è¯­å¥å°±æŠŠç¼“å­˜æ¸…ç©ºäº†ã€‚è¿™æ ·å¯¹äºæ›´æ–°æ“ä½œæ¯”è¾ƒé¢‘ç¹çš„æ•°æ®åº“æ¥è¯´ï¼ŒæŸ¥è¯¢ç¼“å­˜çš„å‘½ä¸­ç‡ä¼šéå¸¸ä½ã€‚é™¤éæ˜¯ä¸€å¼ é™æ€çš„lookUpè¡¨ï¼Œå¾ˆé•¿æ—¶é—´æ‰ä¼šæ›´æ–°ä¸€æ¬¡ã€‚æ¯”å¦‚ç³»ç»Ÿé…ç½®è¡¨ï¼Œè¡Œæ”¿åŒºåˆ’è¡¨ç­‰è¡¨ä¸Šçš„æŸ¥è¯¢æ‰ä¼šæ¯”è¾ƒé€‚åˆä½¿ç”¨æŸ¥è¯¢ç¼“å­˜ã€‚&lt;br&gt;
Â Â  å¥½åœ¨MySQLä¹Ÿæä¾›è¿™ç§â€œæŒ‰éœ€ä½¿ç”¨â€çš„æ–¹å¼ï¼Œä½ å¯ä»¥å°†å‚æ•°query_cache_typeè®¾ç½®ä¸ºDEMANDï¼Œè¿™æ ·å¯¹äºé»˜è®¤çš„SQLè¯­å¥éƒ½ä¸ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜ã€‚ è€Œå¯¹äºä½ ç¡®å®šè¦ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜çš„è¯­å¥å¯ä»¥ç”¨SQL_CACHE æ˜¾å¼æŒ‡å®šï¼Œåƒä¸‹é¢è¿™ä¸ªè¯­å¥ä¸€æ ·ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;select SQL_CACHE * from T where ID=10ï¼›
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒMySQL8.0ç‰ˆæœ¬å·²ç»ç›´æ¥åˆ é™¤äº†æŸ¥è¯¢ç¼“å­˜åŠŸèƒ½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;åˆ†æå™¨&#34;&gt;&lt;strong&gt;åˆ†æå™¨&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;Â Â å¦‚æœæ²¡æœ‰å‘½ä¸­æŸ¥è¯¢ç¼“å­˜ï¼Œå°±è¦å¼€å§‹çœŸæ­£æ‰§è¡ŒSQLè¯­å¥äº†ï¼Œé¦–å…ˆMySQLéœ€è¦çŸ¥é“ä½ è¦åšä»€ä¹ˆï¼Œå› æ­¤éœ€è¦å¯¹MySQLè¯­å¥åšè§£æã€‚&lt;br&gt;
Â Â åˆ†æå™¨ä¼šç°åšâ€œè¯æ³•è§£æâ€ï¼Œä½ è¾“å…¥çš„æ˜¯ç”±å¤šä¸ªå­—ç¬¦ä¸²å’Œç©ºæ ¼ç»„æˆçš„ä¸€æ¡SQLè¯­å¥ï¼ŒMySQLéœ€è¦è¯†åˆ«å‡ºé‡Œé¢çš„å­—ç¬¦ä¸²åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Œä»£è¡¨ä»€ä¹ˆã€‚&lt;/p&gt;
&lt;p&gt;Â Â MySQL ä»ä½ è¾“å…¥çš„&amp;quot;select&amp;quot;è¿™ä¸ªå…³é”®å­—è¯†åˆ«å‡ºæ¥ï¼Œè¿™æ˜¯ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ã€‚å®ƒä¹Ÿè¦æŠŠå­—ç¬¦ä¸²â€œTâ€è¯†åˆ«æˆâ€œè¡¨å Tâ€ï¼ŒæŠŠå­—ç¬¦ä¸²â€œIDâ€è¯†åˆ«æˆâ€œåˆ— IDâ€ã€‚&lt;br&gt;
Â Â åšå®Œäº†è¿™äº›è¯†åˆ«ä»¥åï¼Œå°±è¦åšâ€œè¯­æ³•åˆ†æâ€ã€‚æ ¹æ®è¯æ³•åˆ†æçš„ç»“æœï¼Œè¯­æ³•åˆ†æå™¨ä¼šæ ¹æ®è¯­æ³•è§„åˆ™ï¼Œåˆ¤æ–­ä½ è¾“å…¥çš„è¿™ä¸ª SQL è¯­å¥æ˜¯å¦æ»¡è¶³ MySQL è¯­æ³•ã€‚&lt;br&gt;
Â Â å¦‚æœä½ çš„è¯­å¥ä¸å¯¹ï¼Œå°±ä¼šæ”¶åˆ°â€œYou have an error in your SQL syntaxâ€çš„é”™è¯¯æé†’ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªè¯­å¥ select å°‘æ‰“äº†å¼€å¤´çš„å­—æ¯â€œsâ€ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;
mysql&amp;gt; elect * from t where ID=1;

ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;elect * from t where ID=1&#39; at line 1
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸€èˆ¬è¯­æ³•é”™è¯¯ä¼šæç¤ºç¬¬ä¸€ä¸ªå‡ºç°é”™è¯¯çš„ä½ç½®ï¼Œæ‰€ä»¥ä½ è¦å…³æ³¨çš„æ˜¯ç´§æ¥â€œuse nearâ€çš„å†…å®¹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;a href=&#34;https://tech.meituan.com/2018/05/20/sql-parser-used-in-mtdp.html&#34;&gt;è¯¦ç»†è¯­æ³•SQLè§£ææµç¨‹ï¼Œæ¥è‡ªç¾å›¢æŠ€æœ¯å›¢é˜Ÿï¼Œç‚¹å‡»è·³è½¬&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;ä¼˜åŒ–å™¨&#34;&gt;&lt;strong&gt;ä¼˜åŒ–å™¨&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;Â Â ç»è¿‡äº†åˆ†æå™¨ï¼ŒMySQL å°±çŸ¥é“ä½ è¦åšä»€ä¹ˆäº†ã€‚åœ¨å¼€å§‹æ‰§è¡Œä¹‹å‰ï¼Œè¿˜è¦å…ˆç»è¿‡ä¼˜åŒ–å™¨çš„å¤„ç†ã€‚&lt;br&gt;
Â Â ä¼˜åŒ–å™¨æ˜¯åœ¨è¡¨é‡Œé¢æœ‰å¤šä¸ªç´¢å¼•çš„æ—¶å€™ï¼Œå†³å®šä½¿ç”¨å“ªä¸ªç´¢å¼•ï¼›æˆ–è€…åœ¨ä¸€ä¸ªè¯­å¥æœ‰å¤šè¡¨å…³è”ï¼ˆjoinï¼‰çš„æ—¶å€™ï¼Œå†³å®šå„ä¸ªè¡¨çš„è¿æ¥é¡ºåºã€‚æ¯”å¦‚ä½ æ‰§è¡Œä¸‹é¢è¿™æ ·çš„è¯­å¥ï¼Œè¿™ä¸ªè¯­å¥æ˜¯æ‰§è¡Œä¸¤ä¸ªè¡¨çš„ joinï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; select * from t1 join t2 using(ID) where t1.c=10 and t2.d=20;
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;æ—¢å¯ä»¥å…ˆä»è¡¨ t1 é‡Œé¢å–å‡º c=10 çš„è®°å½•çš„ ID å€¼ï¼Œå†æ ¹æ® ID å€¼å…³è”åˆ°è¡¨ t2ï¼Œå†åˆ¤æ–­ t2 é‡Œé¢ d çš„å€¼æ˜¯å¦ç­‰äº 20ã€‚&lt;/li&gt;
&lt;li&gt;ä¹Ÿå¯ä»¥å…ˆä»è¡¨ t2 é‡Œé¢å–å‡º d=20 çš„è®°å½•çš„ ID å€¼ï¼Œå†æ ¹æ® ID å€¼å…³è”åˆ° t1ï¼Œå†åˆ¤æ–­ t1 é‡Œé¢ c çš„å€¼æ˜¯å¦ç­‰äº 10ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¼˜åŒ–å™¨é˜¶æ®µå®Œæˆåï¼Œè¿™ä¸ªè¯­å¥çš„æ‰§è¡Œæ–¹æ¡ˆå°±ç¡®å®šä¸‹æ¥äº†ï¼Œç„¶åè¿›å…¥æ‰§è¡Œå™¨é˜¶æ®µã€‚å¦‚æœä½ è¿˜æœ‰ä¸€äº›ç–‘é—®ï¼Œæ¯”å¦‚ä¼˜åŒ–å™¨æ˜¯æ€ä¹ˆé€‰æ‹©ç´¢å¼•çš„ï¼Œæœ‰æ²¡æœ‰å¯èƒ½é€‰æ‹©é”™ç­‰ç­‰ï¼Œæˆ‘ä¼šåœ¨åé¢çš„åšå®¢ä¸­å•ç‹¬å±•å¼€è¯´æ˜ä¼˜åŒ–å™¨çš„å†…å®¹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ‰§è¡Œå™¨&#34;&gt;&lt;strong&gt;æ‰§è¡Œå™¨&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;Â Â MySQL é€šè¿‡åˆ†æå™¨çŸ¥é“äº†ä½ è¦åšä»€ä¹ˆï¼Œé€šè¿‡ä¼˜åŒ–å™¨çŸ¥é“äº†è¯¥æ€ä¹ˆåšï¼Œäºæ˜¯å°±è¿›å…¥äº†æ‰§è¡Œå™¨é˜¶æ®µï¼Œå¼€å§‹æ‰§è¡Œè¯­å¥ã€‚&lt;br&gt;
Â Â å¼€å§‹æ‰§è¡Œçš„æ—¶å€™ï¼Œè¦å…ˆåˆ¤æ–­ä¸€ä¸‹ä½ å¯¹è¿™ä¸ªè¡¨ T æœ‰æ²¡æœ‰æ‰§è¡ŒæŸ¥è¯¢çš„æƒé™ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±ä¼šè¿”å›æ²¡æœ‰æƒé™çš„é”™è¯¯ï¼Œå¦‚ä¸‹æ‰€ç¤º (åœ¨å·¥ç¨‹å®ç°ä¸Šï¼Œå¦‚æœå‘½ä¸­æŸ¥è¯¢ç¼“å­˜ï¼Œä¼šåœ¨æŸ¥è¯¢ç¼“å­˜è¿”å›ç»“æœçš„æ—¶å€™ï¼Œåšæƒé™éªŒè¯ã€‚æŸ¥è¯¢ä¹Ÿä¼šåœ¨ä¼˜åŒ–å™¨ä¹‹å‰è°ƒç”¨ precheck éªŒè¯æƒé™)ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; select * from T where ID=10;ERROR 1142 (42000): SELECT command denied to user &#39;b&#39;@&#39;localhost&#39; for table &#39;T&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Â Â å¦‚æœæœ‰æƒé™ï¼Œå°±æ‰“å¼€è¡¨ç»§ç»­æ‰§è¡Œã€‚æ‰“å¼€è¡¨çš„æ—¶å€™ï¼Œæ‰§è¡Œå™¨å°±ä¼šæ ¹æ®è¡¨çš„å¼•æ“å®šä¹‰ï¼Œå»ä½¿ç”¨è¿™ä¸ªå¼•æ“æä¾›çš„æ¥å£ã€‚&lt;br&gt;
Â Â æ¯”å¦‚æˆ‘ä»¬è¿™ä¸ªä¾‹å­ä¸­çš„è¡¨ T ä¸­ï¼ŒID å­—æ®µæ²¡æœ‰ç´¢å¼•ï¼Œé‚£ä¹ˆæ‰§è¡Œå™¨çš„æ‰§è¡Œæµç¨‹æ˜¯è¿™æ ·çš„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è°ƒç”¨ InnoDB å¼•æ“æ¥å£å–è¿™ä¸ªè¡¨çš„ç¬¬ä¸€è¡Œï¼Œåˆ¤æ–­ ID å€¼æ˜¯ä¸æ˜¯ 10ï¼Œå¦‚æœä¸æ˜¯åˆ™è·³è¿‡ï¼Œå¦‚æœæ˜¯åˆ™å°†è¿™è¡Œå­˜åœ¨ç»“æœé›†ä¸­ï¼›&lt;/li&gt;
&lt;li&gt;è°ƒç”¨å¼•æ“æ¥å£å–â€œä¸‹ä¸€è¡Œâ€ï¼Œé‡å¤ç›¸åŒçš„åˆ¤æ–­é€»è¾‘ï¼Œç›´åˆ°å–åˆ°è¿™ä¸ªè¡¨çš„æœ€åä¸€è¡Œã€‚&lt;/li&gt;
&lt;li&gt;æ‰§è¡Œå™¨å°†ä¸Šè¿°éå†è¿‡ç¨‹ä¸­æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„è¡Œç»„æˆçš„è®°å½•é›†ä½œä¸ºç»“æœé›†è¿”å›ç»™å®¢æˆ·ç«¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Â Â è‡³æ­¤ï¼Œè¿™ä¸ªè¯­å¥å°±æ‰§è¡Œå®Œæˆäº†ã€‚å¯¹äºæœ‰ç´¢å¼•çš„è¡¨ï¼Œæ‰§è¡Œçš„é€»è¾‘ä¹Ÿå·®ä¸å¤šã€‚ç¬¬ä¸€æ¬¡è°ƒç”¨çš„æ˜¯â€œå–æ»¡è¶³æ¡ä»¶çš„ç¬¬ä¸€è¡Œâ€è¿™ä¸ªæ¥å£ï¼Œä¹‹åå¾ªç¯å–â€œæ»¡è¶³æ¡ä»¶çš„ä¸‹ä¸€è¡Œâ€è¿™ä¸ªæ¥å£ï¼Œè¿™äº›æ¥å£éƒ½æ˜¯å¼•æ“ä¸­å·²ç»å®šä¹‰å¥½çš„ã€‚&lt;br&gt;
Â Â ä½ ä¼šåœ¨æ•°æ®åº“çš„æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­çœ‹åˆ°ä¸€ä¸ª rows_examined çš„å­—æ®µï¼Œè¡¨ç¤ºè¿™ä¸ªè¯­å¥æ‰§è¡Œè¿‡ç¨‹ä¸­æ‰«æäº†å¤šå°‘è¡Œã€‚è¿™ä¸ªå€¼å°±æ˜¯åœ¨æ‰§è¡Œå™¨æ¯æ¬¡è°ƒç”¨å¼•æ“è·å–æ•°æ®è¡Œçš„æ—¶å€™ç´¯åŠ çš„ã€‚&lt;br&gt;
Â Â åœ¨æœ‰äº›åœºæ™¯ä¸‹ï¼Œæ‰§è¡Œå™¨è°ƒç”¨ä¸€æ¬¡ï¼Œåœ¨å¼•æ“å†…éƒ¨åˆ™æ‰«æäº†å¤šè¡Œï¼Œå› æ­¤å¼•æ“æ‰«æè¡Œæ•°è·Ÿ rows_examined å¹¶ä¸æ˜¯å®Œå…¨ç›¸åŒçš„ã€‚æˆ‘ä»¬åé¢ä¼šä¸“é—¨æœ‰ä¸€ç¯‡æ–‡ç« æ¥è®²å­˜å‚¨å¼•æ“çš„å†…éƒ¨æœºåˆ¶ï¼Œé‡Œé¢ä¼šæœ‰è¯¦ç»†çš„è¯´æ˜ã€‚&lt;/p&gt;
">[2020-04-18]MySQLï¼ˆä¸€ï¼‰SQLçš„æ‰§è¡Œæµç¨‹</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://RookieYan.github.io/post/2020-04-11chong-xin-kai-shi/"" data-c="
          &lt;p&gt;Â Â ä¹‹å‰å› ä¸ºæ­äº†ä¸€ä¸ªNgrokï¼Œè¢«é»‘å®¢æ‰«åˆ°äº†ï¼ŒæŠŠç”µè„‘é»‘äº†ã€‚ç„¶åä»Šå¤©é‡è£…äº†ç³»ç»Ÿï¼Œæ ¼å¼åŒ–äº†ç¡¬ç›˜ï¼Œä¸€ä¸å°å¿ƒæŠŠåšå®¢ä¹Ÿéƒ½æ¸…äº†... æ²¡åŠæ³•...  å›ä¸å»çš„å°±ç•™åœ¨è¿‡å»å§...  é‡æ–°å†™....&lt;/p&gt;
&lt;p&gt;Â Â åŠ æ²¹...&lt;/p&gt;
">[2020-04-11]é‡æ–°å¼€å§‹</a>
      </div>
      
    </div>
  </div>
</div>
<script>
  // var escape = "[{&#34;content&#34;:&#34;&lt;p&gt;Â Â ä»Šå¤©è¯´ä¸€ä¸‹MySQLçš„ä¸¤ä¸ªæ—¥å¿—æ¨¡å—ï¼Œåˆ†åˆ«æ˜¯BinLogå’ŒRedoLogã€‚&lt;br&gt;\nÂ Â å¯èƒ½æœ‰çš„ç ”å‘åŒå­¦ä¼šå¬åˆ°DBAåŒäº‹è¯´MySQLå¯ä»¥æ¢å¤åˆ°åŠä¸ªæœˆå†…çš„ä»»æ„ä¸€ç§’çš„çŠ¶æ€ï¼Œåœ¨æƒŠå¥‡çš„åŒæ—¶ï¼Œå¯èƒ½ä¼šå¥½å¥‡æ˜¯æ€ä¹ˆå®ç°çš„ã€‚æˆ‘ä»¬ä»Šå¤©å°±æ¥èŠèŠè¿™ä¸ªäº‹å„¿ã€‚&lt;/p&gt;\n&lt;p&gt;Â Â å‡å¦‚æˆ‘ä»¬ç°åœ¨æœ‰ä¸€å¼ è¡¨Tï¼Œåªæœ‰ä¸»é”®Idå’Œä¸€ä¸ªæ•´å‹å­—æ®µ cï¼Œç„¶åç°åœ¨æˆ‘ä»¬è¦å°†Id=2è¿™ä¸€è¡Œçš„å€¼åŠ 1ï¼Œé‚£ä¹ˆSQLè¯­å¥åº”è¯¥è¿™ä¹ˆå†™ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;update T set c=c+1 where ID=2;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Â Â ä»ä¸Šä¸€ç¯‡&lt;a href=\&#34;https://rookieyan.github.io/post/2020-04-18mysqlyi-sql-de-zhi-xing-liu-cheng/\&#34;&gt;MySQLï¼ˆä¸€ï¼‰SQLçš„æ‰§è¡Œæµç¨‹&lt;/a&gt;æˆ‘ä»¬åŸºæœ¬å¯ä»¥å¾ˆæ˜ç¡®è¿™æ¡æ›´æ–°çš„SQLè¯­å¥çš„æ‰§è¡Œæµç¨‹ä¼šå’ŒæŸ¥è¯¢æµç¨‹ä¸€æ ·æŠŠæ•´ä¸ªæµç¨‹èµ°ä¸€éã€‚å‰é¢æˆ‘ä»¬ä¹Ÿæœ‰è¯´è¿‡ï¼Œåœ¨å¯¹è¡¨åšæ›´æ–°æ“ä½œçš„æ—¶å€™ï¼Œè·Ÿè¿™ä¸ªè¡¨æœ‰å…³çš„æŸ¥è¯¢ç¼“å­˜ä¼šå¤±æ•ˆï¼Œæ‰€ä»¥è¿™æ¡è¯­å¥çš„æ‰§è¡Œä¼šæŠŠè¡¨Tä¸Šçš„æŸ¥è¯¢ç¼“å­˜ä¸­ç»“æœéƒ½æ¸…ç©ºã€‚è¿™ä¹Ÿæ˜¯æˆ‘ä»¬ä¸€èˆ¬ä¸å»ºè®®ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜çš„åŸå› ã€‚&lt;br&gt;\n&lt;img src=\&#34;https://RookieYan.github.io/post-images/1588350320310.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;br&gt;\nÂ Â æ¥ä¸‹æ¥åˆ†æå™¨ä¼šé€šè¿‡è¯æ³•å’Œè¯­æ³•è§£æçŸ¥é“è¿™æ˜¯ä¸€æ¡æ›´æ–°è¯­å¥ã€‚ä¼˜åŒ–å™¨ä¼šå†³å®šè¦ä½¿ç”¨IDå¯¹åº”çš„ä¸»é”®ç´¢å¼•ã€‚æ‰§è¡Œå™¨è´Ÿè´£å…·ä½“çš„æ‰§è¡Œæ“ä½œï¼Œæ‰¾åˆ°å¯¹åº”çš„è¿™ä¸€è¡Œï¼Œç„¶åæ›´æ–°ã€‚&lt;/p&gt;\n&lt;p&gt;Â Â å’ŒæŸ¥è¯¢æµç¨‹ä¸ä¸€æ ·çš„æ˜¯ï¼Œåœ¨æ›´æ–°æµç¨‹ä¸­ï¼Œä¼šæ¶‰åŠåˆ°ä¸¤ä¸ªæ¯”è¾ƒé‡è¦çš„æ—¥å¿—æ¨¡å—ã€‚ä»–ä»¬æ­£æ˜¯æˆ‘ä»¬ä»Šå¤©è¦è®¨è®ºçš„ä¸»è§’ï¼š&lt;strong&gt;redologï¼ˆé‡åšæ—¥å¿—ï¼‰å’Œbinlogï¼ˆå½’æ¡£æ—¥å¿—ï¼‰&lt;/strong&gt;ã€‚ å¦‚æœæ¥è§¦è¿‡MySQLï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªè¯è‚¯å®šæ˜¯ç»•ä¸è¿‡å»çš„ã€‚å¹¶ä¸”è¿™ä¸¤ä¸ªæ—¥å¿—æ¨¡å—åœ¨è®¾è®¡ä¸Šä¹Ÿæœ‰å¾ˆå¤šæœ‰æ„æ€çš„åœ°æ–¹ï¼Œå¯ä»¥å°†è®¾è®¡æ€è·¯è¿ç”¨åˆ°è‡ªå·±å¹³æ—¶çš„è®¾è®¡å’Œå¼€å‘ä¸­ã€‚&lt;/p&gt;\n&lt;h2 id=\&#34;1-redo-log\&#34;&gt;**1. redo log **&lt;/h2&gt;\n&lt;p&gt;Â Â æœ‰ä¸€ä¸ªğŸŒ°å¯ä»¥å¾ˆå¥½çš„è§£é‡Šè¿™ä¸ªæ—¥å¿—æ¨¡å—ã€‚ã€Šå­”ä¹™å·±ã€‹é‚£ç¯‡æ–‡ç« ä¸­ï¼Œé…’é¦†è€æ¿æœ‰ä¸€ä¸ªå°é»‘æ¿å’Œä¸€æœ¬è´¦æœ¬ï¼Œä¸“é—¨è®°å½•å®¢äººèµŠè´¦çš„æƒ…å†µã€‚å¦‚æœæœ‰äººè¦èµŠè´¦æˆ–è€…è¿˜è´¦çš„è¯ï¼Œé…’é¦†è€æ¿ä¸€èˆ¬æœ‰ä¸¤ç§åšæ³•ï¼š&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;æŠŠè´¦æœ¬ç¿»å‡ºæ¥ï¼Œæ‰¾åˆ°å®¢äººå¯¹åº”çš„è®°å½•ï¼Œåšæ›´æ–°æ“ä½œã€‚&lt;/li&gt;\n&lt;li&gt;å…ˆåœ¨å°é»‘æ¿ä¸Šè®°å½•ä¸‹æ¥è¿™æ¬¡çš„å¸ï¼Œç­‰åˆ°æ‰“çƒŠåå†æŠŠè´¦å•ç¿»å‡ºæ¥æ ¸ç®—ã€‚&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;Â Â åœ¨ç”Ÿæ„æ¯”è¾ƒå¿™ç¢Œçš„æƒ…å†µä¸‹ï¼Œé…’é¦†è€æ¿ä¸€å®šä¼šé€‰æ‹©åè€…ï¼Œå› ä¸ºå‰è€…æ˜¯åœ¨å¤ªéº»çƒ¦äº†ï¼Œéœ€è¦ä»è´¦æœ¬ä¸­å‡†ç¡®æ‰¾åˆ°å®¢äººçš„è®°å½•ï¼ˆå¯èƒ½è¿˜æ²¡æœ‰ç´¢å¼•ï¼‰ï¼Œæ•°ç›®æ¯”è¾ƒå¤§çš„è¯å¯èƒ½è¿˜éœ€è¦ç”¨ç®—ç›˜ç®—ä¸€ä¸‹ï¼Œæœ€åå†æŠŠç»“æœå†™åˆ°è´¦æœ¬ä¸Šã€‚å¦‚æœæ¯”è¾ƒå¿™çš„æƒ…å†µä¸‹ã€‚è¿™ç§æ–¹å¼ä¸€å®šæ˜¯ä¸å¯å–çš„ã€‚ ä¸å¦‚å…ˆå†™åœ¨å°é»‘æ¿ä¸Šï¼Œç­‰åˆ°ç©ºé—²çš„æ—¶å€™ï¼Œå†å»æŠŠè´¦ç›®åŒæ­¥åˆ°è´¦æœ¬ä¸Šã€‚&lt;/p&gt;\n&lt;p&gt;Â Â åŒæ ·çš„åœ¨MySQLä¸­ä¹Ÿæœ‰ç›¸ä¼¼çš„é—®é¢˜ï¼Œæ¯ä¸€æ¬¡çš„æ›´æ–°æ“ä½œéƒ½éœ€è¦å†™è¿›ç£ç›˜é‡Œï¼Œç„¶åç£ç›˜ä¹Ÿéœ€è¦æ‰¾åˆ°å¯¹åº”çš„è®°å½•åšæ›´æ–°æ“ä½œã€‚æ•´ä¸ªè¿‡ç¨‹çš„IOæˆæœ¬å’ŒæŸ¥æ‰¾æˆæœ¬éƒ½æ˜¯æ¯”è¾ƒé«˜çš„ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒMySQLçš„è®¾è®¡è€…å°±æƒ³åˆ°äº†ç±»ä¼¼äºé…’é¦†è€æ¿è®°è´¦çš„æ€è·¯æ¥æå‡æ•ˆç‡ï¼Œå‡å°‘IOã€‚&lt;/p&gt;\n&lt;p&gt;Â Â æ‰€ä»¥å°é»‘æ¿å’Œè´¦å•é…åˆçš„è¿‡ç¨‹ï¼Œå°±æ˜¯MySQLé‡Œç»å¸¸è¯´åˆ°çš„&lt;strong&gt;WALæŠ€æœ¯ï¼ŒWALæŠ€æœ¯çš„å…¨ç§°æ˜¯Write-Ahead Loggingï¼Œå®ƒçš„å…³é”®ç‚¹å°±æ˜¯å…ˆå†™æ—¥å¿—ï¼Œå†å†™ç£ç›˜ï¼Œä¹Ÿå°±æ˜¯å…ˆå†™ç²‰æ¿ï¼Œç­‰ä¸å¿™çš„æ—¶å€™å†å†™è´¦æœ¬ã€‚&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Â Â å…·ä½“æ¥è¯´å°±æ˜¯ï¼Œå½“æœ‰ä¸€æ¡è®°å½•éœ€è¦è¢«æ›´æ–°çš„æ—¶å€™ï¼ŒInnoDBå¼•æ“å°±ä¼šå…ˆæŠŠè®°å½•ç»™å†™åˆ°redo logä¸­ï¼ˆå°é»‘æ¿ï¼‰ï¼Œå¹¶ä¸”æ›´æ–°å†…å­˜ã€‚ è¿™ä¸ªæ—¶å€™æ›´æ–°å°±ç®—å®Œæˆäº†ã€‚ åŒæ—¶InnoDBä¼šåœ¨æ¯”è¾ƒåˆé€‚çš„æ—¶å€™ï¼ŒæŠŠè¿™ä¸ªæ“ä½œè®°å½•æ›´æ–°åˆ°ç£ç›˜ä¸­ï¼Œè€Œè¿™ä¸ªæ›´æ–°ä¸€èˆ¬ä¼šæ˜¯åœ¨ç³»ç»Ÿæ¯”è¾ƒç©ºé—²çš„æ—¶å€™å»åšçš„ï¼ˆç±»ä¼¼äºè€æ¿æ‰“çƒŠååšçš„äº‹å„¿ï¼‰ã€‚&lt;/p&gt;\n&lt;p&gt;Â Â å½“ç„¶ä½ å¯èƒ½ä¼šé—®ï¼Œä¼šä¸ä¼šæœ‰ä¸€ç§æƒ…å†µï¼Œå°±æ˜¯ä»Šå¤©ç”Ÿæ„å¤ªå¥½äº†ï¼Œå°é»‘æ¿éƒ½è¢«å†™æ»¡äº†ï¼Œé‚£æ€ä¹ˆåŠå‘¢ï¼Ÿ å¦‚æœæ˜¯è¿™ç§æƒ…å†µçš„è¯ï¼Œé‚£ä¹ˆåªèƒ½è®©è€æ¿åœä¸‹æ‰‹ä¸­çš„æ´»ï¼Œå…ˆå»æŠŠè´¦æœ¬æ›´æ–°äº†ï¼Œç„¶åæ“¦é™¤é»‘æ¿ä¸Šçš„è®°å½•ï¼Œè…¾å‡ºç©ºé—´ï¼Œå†å†™ä¸Šæ–°çš„è®°å½•ã€‚InnoDBçš„redo logæ˜¯å›ºå®šå¤§å°çš„ï¼Œæ¯”å¦‚å¯ä»¥é…ç½®ä¸€ç»„æ˜¯4ä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶å°ä¸º1Gï¼Œé‚£ä¹ˆè¿™å—â€œå°é»‘æ¿â€æ€»å…±å°±å¯ä»¥è®°å½•4Gçš„æ“ä½œè®°å½•ï¼Œä»å¤´å¼€å§‹å†™ï¼Œå†™åˆ°æœ«å°¾å°±å†ä»å¤´å¼€å§‹å†™ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;br&gt;\n&lt;img src=\&#34;https://RookieYan.github.io/post-images/1588354832158.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;br&gt;\nÂ Â write posæ˜¯å½“å‰è®°å½•çš„ä½ç½®ï¼Œä¸€è¾¹å†™ä¸€è¾¹åç§»ï¼Œå†™åˆ°LogFile3çš„æœ«å°¾å°±åˆ°äº†LogFile0çš„å¼€å¤´ç»§ç»­å†™ï¼Œcheck pointæ˜¯å½“å‰è¦æ“¦é™¤çš„ä½ç½®ï¼Œä¹Ÿæ˜¯ä¸€æ ·è¦å¾€åç§»å¹¶ä¸”å¾ªç¯çš„ï¼Œæ“¦é™¤è®°å½•å‰è¦æŠŠè®°å½•æ›´æ–°åˆ°æ•°æ®æ–‡ä»¶ä¸­ã€‚&lt;/p&gt;\n&lt;p&gt;Â Â write pos å’Œ checkpoint ä¹‹é—´çš„ç»¿è‰²éƒ¨åˆ†æ˜¯â€œå°é»‘æ¿â€ä¸Šè¿˜ç©ºç€çš„éƒ¨åˆ†ï¼Œå¯ä»¥ç”¨æ¥è®°å½•æ–°çš„æ“ä½œã€‚å¦‚æœ write pos è¿½ä¸Š checkpointï¼Œè¡¨ç¤ºâ€œå°é»‘æ¿â€æ»¡äº†ï¼Œè¿™æ—¶å€™ä¸èƒ½å†æ‰§è¡Œæ–°çš„æ›´æ–°ï¼Œå¾—åœä¸‹æ¥å…ˆæ“¦æ‰ä¸€äº›è®°å½•ï¼ŒæŠŠ checkpoint æ¨è¿›ä¸€ä¸‹ã€‚&lt;/p&gt;\n&lt;p&gt;Â Â è‡³æ­¤ï¼Œæœ‰äº†redologï¼ŒInnoDBå°±å¯ä»¥ä¿è¯æ•°æ®åœ¨å‘ç”Ÿæ•°æ®åº“å¼‚å¸¸é‡å¯çš„æ—¶å€™ï¼Œä¹‹å‰æäº¤çš„æ•°æ®éƒ½ä¸ä¼šä¸¢å¤±ï¼Œè¿™ä¸ªèƒ½åŠ›ç§°ä¸º&lt;strong&gt;crash-safe&lt;/strong&gt;ã€‚&lt;/p&gt;\n&lt;h2 id=\&#34;2-bin-log\&#34;&gt;**2. bin log **&lt;/h2&gt;\n&#34;,&#34;fileName&#34;:&#34;2020-04-18mysqler-redolog-he-binlog&#34;,&#34;abstract&#34;:&#34;&#34;,&#34;title&#34;:&#34; [2020-04-18]MySQLï¼ˆäºŒï¼‰RedoLogå’ŒBinLog&#34;,&#34;tags&#34;:[],&#34;date&#34;:&#34;2020-05-02 00:04:49&#34;,&#34;dateFormat&#34;:&#34;2020-05-02&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://RookieYan.github.io/post/2020-04-18mysqler-redolog-he-binlog/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;5 min read&#34;,&#34;time&#34;:279000,&#34;words&#34;:1343,&#34;minutes&#34;:5},&#34;description&#34;:&#34;Â Â ä»Šå¤©è¯´ä¸€ä¸‹MySQLçš„ä¸¤ä¸ªæ—¥å¿—æ¨¡å—ï¼Œåˆ†åˆ«æ˜¯BinLogå’ŒRedoLogã€‚\nÂ Â å¯èƒ½æœ‰çš„ç ”å‘åŒå­¦ä¼šå¬åˆ°DBAåŒäº‹è¯´MySQLå¯ä»¥æ¢å¤åˆ°åŠä¸ªæœˆå†…çš„ä»»æ„ä¸€ç§’çš„çŠ¶æ€ï¼Œåœ¨æƒŠå¥‡çš„åŒæ—¶ï¼Œå¯èƒ½ä¼šå¥½å¥‡æ˜¯æ€ä¹ˆå®ç°çš„ã€‚æˆ‘ä»¬ä»Šå¤©å°±æ¥èŠèŠè¿™ä¸ªäº‹å„¿ã€‚\nÂ Â å‡å¦‚æˆ‘ä»¬...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#1-redo-log\&#34;&gt;**1. redo log **&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#2-bin-log\&#34;&gt;**2. bin log **&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;h2 id=\&#34;0-å‡†å¤‡å·¥ä½œ\&#34;&gt;&lt;strong&gt;0. å‡†å¤‡å·¥ä½œ&lt;/strong&gt;&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;é¦–å…ˆå‡†å¤‡ä¸¤å°ECSï¼ˆæˆ‘ç”¨çš„æ˜¯é˜¿é‡Œäº‘çš„4æ ¸8Gï¼Œä¹°äº†ä¸€ä¸ªå‘¨ï¼Œå‡†å¤‡æä¸€ä¸‹ï¼‰&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&#34;1-ç¯å¢ƒé…ç½®\&#34;&gt;&lt;strong&gt;1. ç¯å¢ƒé…ç½®&lt;/strong&gt;&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;éœ€è¦Docker 19.03ï¼ˆå¦‚æœä½¿ç”¨è¾ƒä½ç‰ˆæœ¬ï¼Œåˆ™å¯èƒ½ä¼šå‡ºç°K3Sæ— æ³•å¯åŠ¨çš„é—®é¢˜ï¼‰&lt;/li&gt;\n&lt;/ul&gt;\n&lt;ol&gt;\n&lt;li&gt;éœ€è¦æŠŠyum åŒ…æ›´æ–°åˆ°æœ€æ–°&lt;/li&gt;\n&lt;/ol&gt;\n&lt;pre&gt;&lt;code&gt;yum  update\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;img src=\&#34;https://RookieYan.github.io/post-images/1587476469607.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;br&gt;\n2. å®‰è£…éœ€è¦çš„ä¾èµ–åŒ… yum-utilæä¾›yum-config-manageråŠŸèƒ½ï¼Œå¦å¤–ä¸¤ä¸ªæ˜¯devicemapperé©±åŠ¨ä¾èµ–çš„ã€‚&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;yum install -y yum-utils  device-mapper-persistent-data  lvm2\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;img src=\&#34;https://RookieYan.github.io/post-images/1587476490002.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;br&gt;\n3. è®¾ç½®yumæº&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo\n&lt;/code&gt;&lt;/pre&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://RookieYan.github.io/post-images/1587476599172.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;ol start=\&#34;4\&#34;&gt;\n&lt;li&gt;å®‰è£…dockerï¼Œå‡ºç°è¾“å…¥çš„ç•Œé¢éƒ½è¾“å…¥y&lt;/li&gt;\n&lt;/ol&gt;\n&lt;pre&gt;&lt;code&gt;yum install  -y docker-ce\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;img src=\&#34;https://RookieYan.github.io/post-images/1587476923202.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;br&gt;\n5. å®‰è£…å®ŒæˆæŸ¥çœ‹ç‰ˆæœ¬&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;docker -v\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;img src=\&#34;https://RookieYan.github.io/post-images/1587476969274.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;br&gt;\n6.å¯åŠ¨ Docker&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;/bin/systemctl start docker.service\nå¦‚æœä¸å¯åŠ¨docker ä¼šå¯¼è‡´K3Sæ— æ³•æ­£å¸¸å¯åŠ¨\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;2-å®‰è£…k3smaster\&#34;&gt;&lt;strong&gt;2. å®‰è£…K3SMaster&lt;/strong&gt;&lt;/h2&gt;\n&lt;ol&gt;\n&lt;li&gt;å›½å†…èŠ‚ç‚¹æ¯”è¾ƒå¿«&lt;/li&gt;\n&lt;/ol&gt;\n&lt;pre&gt;&lt;code&gt;curl -sfL https://docs.rancher.cn/k3s/k3s-install.sh | INSTALL_K3S_MIRROR=cn sh -s - server --docker\n&lt;/code&gt;&lt;/pre&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;2\&#34;&gt;&lt;img src=\&#34;https://RookieYan.github.io/post-images/1587477633426.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;ol start=\&#34;2\&#34;&gt;\n&lt;li&gt;ä»ä¸Šé¢çš„å®‰è£…æ—¥å¿—ä¹Ÿå¯ä»¥çœ‹åˆ°kubectlåªæ˜¯ä¸ªè½¯é“¾æ¥ï¼Œè¯¦ç»†å¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/li&gt;\n&lt;/ol&gt;\n&lt;pre&gt;&lt;code&gt;which kubectl\n\nls -l /usr/local/bin/kubectl\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;img src=\&#34;https://RookieYan.github.io/post-images/1587482331193.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;br&gt;\n3. ç¡®è®¤ç‰ˆæœ¬ä¿¡æ¯&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;kubectl version\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;img src=\&#34;https://RookieYan.github.io/post-images/1587482516688.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;br&gt;\n4. è·å–èŠ‚ç‚¹ä¿¡æ¯&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;kubectl get node -o wide\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;img src=\&#34;https://RookieYan.github.io/post-images/1587482618242.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;br&gt;\n&lt;strong&gt;è¿™ä¸¤æ­¥æ­¥æ˜æ˜¾æ˜¯å­˜åœ¨é—®é¢˜çš„.. æŸ¥äº†ä¸€äº›èµ„æ–™.. æ²¡èƒ½è§£å†³..&lt;br&gt;\næ­£ç¡®çš„æ˜¾ç¤ºåº”è¯¥æ˜¯ï¼š&lt;/strong&gt;&lt;br&gt;\n&lt;img src=\&#34;https://RookieYan.github.io/post-images/1587482705796.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;br&gt;\n&lt;img src=\&#34;https://RookieYan.github.io/post-images/1587482682298.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;å°è¯•äº†å¥½å‡ ç§æ–¹å¼ï¼Œåæ¥é˜´å·®é˜³é”™çš„è§£å†³äº†.. éœ€è¦çŸ¥é“åŸå› ï¼ è§£å†³æ–¹å¼æ˜¯ï¼Œæ— æ„é—´åœ¨å‘½ä»¤è¡Œè¾“å…¥äº†&lt;/strong&gt;&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;k3s server &amp;amp; \n\nk3s server stop\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;ä¼¼ä¹æ‰§è¡Œèµ·äº†ä»€ä¹ˆä¸œè¥¿.. å†ä½¿ç”¨ä¸Šé¢çš„å‘½ä»¤ï¼Œå°±å¯ä»¥çœ‹åˆ°masteræ­£å¸¸å¯åŠ¨äº†..&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;æ‰¾åˆ°äº†åŸå› æ˜¯å› ä¸º å®‰è£…K3Sä¹‹å‰æœªå¯åŠ¨Docker!!!!&lt;/strong&gt;&lt;br&gt;\n5. æŸ¥çœ‹K3SçŠ¶æ€&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;/bin/systemctl status k3s\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;3-nodeèŠ‚ç‚¹ç™»å½•\&#34;&gt;&lt;strong&gt;3. NodeèŠ‚ç‚¹ç™»å½•&lt;/strong&gt;&lt;/h2&gt;\n&lt;ol&gt;\n&lt;li&gt;K3S_TOKENæ˜¯serverç«¯çš„ï¼Œä½äº/var/lib/rancher/k3s/server/node-tokenä¸‹&lt;/li&gt;\n&lt;/ol&gt;\n&lt;pre&gt;&lt;code&gt;cat /var/lib/rancher/k3s/server/node-token\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;img src=\&#34;https://RookieYan.github.io/post-images/1587484770708.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;br&gt;\n2. åœ¨agentèŠ‚ç‚¹ä¸Šå®‰è£… å¹¶ä¸”æ·»åŠ åˆ°masterä¸­&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;curl -sfL https://docs.rancher.cn/k3s/k3s-install.sh | INSTALL_K3S_MIRROR=cn K3S_URL=https://172.26.XXX.14:6443 K3S_TOKEN=K102edd25b832c1442cffc113ba1dc78cbf1f26921f8481bee022b8a::server:bf20ed594c877be17d03a840 sh -s - --docker\n\nå¦‚æœå¡«å†™çš„æ˜¯å…¬ç½‘IP åˆ™éœ€è¦å»é˜¿é‡Œæ·»åŠ å®‰å…¨ç»„ å¼€æ”¾6443ç«¯å£\nå¦‚æœæ˜¯å†…ç½‘åˆ™ä¸éœ€è¦åšç›¸å…³æ“ä½œ\n&lt;/code&gt;&lt;/pre&gt;\n&lt;ol start=\&#34;3\&#34;&gt;\n&lt;li&gt;æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ æ£€æŸ¥çŠ¶æ€&lt;/li&gt;\n&lt;/ol&gt;\n&lt;pre&gt;&lt;code&gt;/bin/systemctl status k3s-agent\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;4-éœ€è¦å®‰è£…mavenå’ŒgitåŒæ—¶æŠŠä»£ç pullä¸‹æ¥\&#34;&gt;&lt;strong&gt;4.  éœ€è¦å®‰è£…mavenå’ŒGitåŒæ—¶æŠŠä»£ç pullä¸‹æ¥&lt;/strong&gt;&lt;/h2&gt;\n&lt;ol&gt;\n&lt;li&gt;å®‰è£…JDK&lt;br&gt;\nhttps://blog.csdn.net/qq_42670220/article/details/90753244&lt;br&gt;\nå®‰è£…rzï¼ˆæ–¹ä¾¿æœ¬åœ°åŒ…ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼‰&lt;/li&gt;\n&lt;/ol&gt;\n&lt;pre&gt;&lt;code&gt;yum install -y lrzsz \n\nå®‰è£…å®Œéœ€è¦åˆ·æ–°é…ç½®\nsource /etc/profile\n&lt;/code&gt;&lt;/pre&gt;\n&lt;ol start=\&#34;2\&#34;&gt;\n&lt;li&gt;å®‰è£…Maven&lt;br&gt;\nhttps://www.cnblogs.com/cannel/p/11104190.html&lt;/li&gt;\n&lt;/ol&gt;\n&lt;pre&gt;&lt;code&gt;vim /etc/profile\nsource /etc/profile\n&lt;/code&gt;&lt;/pre&gt;\n&lt;ol start=\&#34;3\&#34;&gt;\n&lt;li&gt;å®‰è£…Git&lt;br&gt;\nhttps://www.cnblogs.com/wulixia/p/11016684.html&lt;/li&gt;\n&lt;li&gt;ä½¿ç”¨Git æŠŠä»£ç pullä¸‹æ¥&lt;/li&gt;\n&lt;/ol&gt;\n&lt;pre&gt;&lt;code&gt;è¿™é‡Œéœ€è¦å…ˆé…ç½®ç§é’¥\nssh-keygen -o\n\ncat cat /root/.ssh/id_rsa.pub\n\né…ç½®åˆ°gitblitä¸Š\n\ngit clone -b devops ssh://yanjianxun@47.93.249.207:29418/~admin/cloud-data-center.git\n&lt;/code&gt;&lt;/pre&gt;\n&lt;ol start=\&#34;5\&#34;&gt;\n&lt;li&gt;ç¼–å†™ Dockerfile&lt;br&gt;\nè·Ÿpom.xmlåŒçº§ç›®å½•ï¼Œ åé¢ä¼šå†™shellè„šæœ¬ï¼Œ è¿™é‡Œçš„Dockerfile å¯èƒ½æ²¡ç”¨äº†ã€‚&lt;/li&gt;\n&lt;/ol&gt;\n&lt;pre&gt;&lt;code&gt;FROM java:8-jdk-alpine\nLABEL maintainer sunzhe/www.sunzhe.com\nRUN apk upgrade\nRUN  apk add -U  tzdata &amp;amp;&amp;amp; \\\n      ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\nCOPY ./target/cloud-data-center.jar ./\nEXPOSE 12313\nCMD java -jar /cloud-data-center.jar &amp;gt; cloud-portal.log.out 2&amp;gt;&amp;amp;1\n&lt;/code&gt;&lt;/pre&gt;\n&lt;ol start=\&#34;6\&#34;&gt;\n&lt;li&gt;æ‰§è¡ŒDockerfile&lt;/li&gt;\n&lt;/ol&gt;\n&lt;pre&gt;&lt;code&gt;docker build -f Dockerfile -t haimanyun/cloud-data-center:1.0.0 .\n&lt;/code&gt;&lt;/pre&gt;\n&lt;ol start=\&#34;7\&#34;&gt;\n&lt;li&gt;ç¼–å†™è„šæœ¬&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h2 id=\&#34;5-å®‰è£…harbor\&#34;&gt;&lt;strong&gt;5.  å®‰è£…harbor&lt;/strong&gt;&lt;/h2&gt;\n&lt;ol&gt;\n&lt;li&gt;ä¸‹è½½ï¼Œè§£å‹ (å¦‚æœè‡ªå®¶ç½‘ç»œå¥½ï¼Œå¯ä»¥ä¸‹è½½ä¸‹æ¥å†ä¸Šä¼ åˆ°æœåŠ¡å™¨)&lt;/li&gt;\n&lt;/ol&gt;\n&lt;pre&gt;&lt;code&gt;wget https://github.com/goharbor/harbor/releases/download/v1.10.2/harbor-offline-installer-v1.10.2.tgz\n\ntar  -zxf  harbor-offline-installer-v1.10.2.tgz\n&lt;/code&gt;&lt;/pre&gt;\n&lt;ol start=\&#34;2\&#34;&gt;\n&lt;li&gt;ä¿®æ”¹é…ç½®&lt;/li&gt;\n&lt;/ol&gt;\n&lt;pre&gt;&lt;code&gt;ä¿®æ”¹ harbor.yml -&amp;gt; hostname:æ”¹ä¸ºæœ¬æœºipï¼Œ ä¿®æ”¹http:port,  æ³¨é‡Šæ‰å…³äº httpsçš„é…ç½®ï¼Œä¿®æ”¹å¯†ç \n&lt;/code&gt;&lt;/pre&gt;\n&lt;ol start=\&#34;3\&#34;&gt;\n&lt;li&gt;å®‰è£…docker-compose&lt;/li&gt;\n&lt;/ol&gt;\n&lt;pre&gt;&lt;code&gt;yum -y install docker-compose\n&lt;/code&gt;&lt;/pre&gt;\n&lt;ol start=\&#34;4\&#34;&gt;\n&lt;li&gt;ä¿®æ”¹dockeré…ç½®&lt;/li&gt;\n&lt;/ol&gt;\n&lt;pre&gt;&lt;code&gt;systemctl status docker  æ‰¾åˆ°dockerè·¯å¾„\n\ndocker.service ä¸­æ·»åŠ é…ç½® -&amp;gt; vim /usr/lib/systemd/system/docker.service \n        ä¸­ ExecStart= åé¢æ·»åŠ ä¸Š --insecure-registry=39.101.174.47:5656\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;img src=\&#34;https://RookieYan.github.io/post-images/1587667006811.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;br&gt;\n5.  é‡å¯docker&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;systemctl daemon-reload\nsystemctl restart docker\n&lt;/code&gt;&lt;/pre&gt;\n&lt;ol start=\&#34;6\&#34;&gt;\n&lt;li&gt;æ‰§è¡Œharborçš„å®‰è£…è„šæœ¬ï¼Œå¯åŠ¨harbor&lt;/li&gt;\n&lt;/ol&gt;\n&lt;pre&gt;&lt;code&gt;sh install.sh\n&lt;/code&gt;&lt;/pre&gt;\n&lt;ol start=\&#34;7\&#34;&gt;\n&lt;li&gt;ç™»å½•harbor&lt;/li&gt;\n&lt;/ol&gt;\n&lt;pre&gt;&lt;code&gt;docker login ip:port ç”¨æˆ·åé»˜è®¤ä¸ºadmin å¯†ç ä¸ºè‡ªå·±ä¿®æ”¹é…ç½®æ–‡ä»¶è®¾ç½®å¥½çš„\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;6-ç¼–å†™è„šæœ¬æ–‡ä»¶mavenæ‰“åŒ…dockeråˆ¶ä½œé•œåƒä¾èµ–çš„æ˜¯ç›®å½•ä¸‹çš„dockerfile\&#34;&gt;&lt;strong&gt;6.  ç¼–å†™è„šæœ¬æ–‡ä»¶ï¼Œmavenæ‰“åŒ…+dockeråˆ¶ä½œé•œåƒï¼ˆä¾èµ–çš„æ˜¯ç›®å½•ä¸‹çš„Dockerfileï¼‰&lt;/strong&gt;&lt;/h2&gt;\n&lt;ol&gt;\n&lt;li&gt;Dockerfile&lt;/li&gt;\n&lt;/ol&gt;\n&lt;pre&gt;&lt;code&gt;FROM java:8-jdk-alpine\nLABEL ceshi/www.ceshi.com\nRUN apk upgrade\nRUN  apk add -U  tzdata &amp;amp;&amp;amp; \\\n      ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\nCOPY ./target/cloud-data-center.jar ./\nEXPOSE 12313\nCMD java -jar /cloud-data-center.jar &amp;gt; cloud-portal.log.out 2&amp;gt;&amp;amp;1\n&lt;/code&gt;&lt;/pre&gt;\n&lt;ol start=\&#34;2\&#34;&gt;\n&lt;li&gt;é…ç½®æ–‡ä»¶&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;cloud-data-center.yaml&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;---\napiVersion: apps/v1\nkind: Deployment \nmetadata:\n  name: cloud-data-center\n  namespace: kube-system \nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      project: kube-system\n      app: cloud-data-center\n  template:\n    metadata:\n      labels:\n        project: kube-system \n        app: cloud-data-center\n    spec:\n      imagePullSecrets:\n      - name: registry-pull-secret\n      containers:\n      - name: cloud-data-center\n        image: 39.101.204.17:5656/k3s/cloud-data-center:2020-04-24-02-20-49\n        imagePullPolicy: Always\n        ports:\n          - protocol: TCP\n            containerPort: 12313\n        env:\n          - name: JAVA_OPTS\n            value: &amp;quot;-Xmx1G&amp;quot;\n        resources:\n          requests:\n            cpu: 0.1\n            memory: 128Mi\n          limits:\n            cpu: 0.1\n            memory: 1Gi\n        readinessProbe:\n          tcpSocket:\n            port: 12313\n          initialDelaySeconds: 60\n          periodSeconds: 10\n        livenessProbe:\n          tcpSocket:\n            port: 12313\n          initialDelaySeconds: 60\n          periodSeconds: 10\n&lt;/code&gt;&lt;/pre&gt;\n&lt;ol start=\&#34;3\&#34;&gt;\n&lt;li&gt;é…ç½®æ–‡ä»¶&lt;br&gt;\nå¯ä»¥å…ˆæ‰§è¡Œï¼Œ æ‰§è¡Œæ–¹å¼ä¸º kubectl apply -f cloud-data-center-ser.yaml&lt;/li&gt;\n&lt;/ol&gt;\n&lt;pre&gt;&lt;code&gt;apiVersion: v1\nkind: Service\nmetadata:\n  name: cloud-data-center\n  namespace: kube-system\nspec:\n  type: NodePort\n  ports:\n  - port: 12313\n    name: cloud-data-center\n  selector:\n    project: kube-system\n    app: cloud-data-center\n&lt;/code&gt;&lt;/pre&gt;\n&lt;ol start=\&#34;4\&#34;&gt;\n&lt;li&gt;è„šæœ¬&lt;/li&gt;\n&lt;/ol&gt;\n&lt;pre&gt;&lt;code&gt;#!/bin/bash\ndocker_registry=39.101.174.47:5656\nkubectl create secret docker-registry registry-pull-secret --docker-server=$docker_registry --docker-username=ceshi --docker-password=Cheshi123456 --docker-email=ceshi@123.com -n kube-system\n#service_list=&amp;quot;cloud-data-center&amp;quot;\n#service_list=${1:-${service_list}}\nservice=&amp;quot;cloud-data-center&amp;quot;\ncurrent_dir=$(pwd)\ncd /data/code/cloud-data-center/cloud-data-center\necho ${current_dir}\n# git checkout devops\n# -b devops ssh://yanjianxun@47.93.249.207:29418/~admin/cloud-data-center.git\ngit pull\nmvn -f XX/XX/pom.xml clean\nmvn -f XX/XX/pom.xml install\nimage_name=$docker_registry/k3s/${service}:$(date +%F-%H-%M-%S)\nsudo docker build -t ${image_name} .\nsudo docker push ${image_name}\necho ${current_dir}\nsed -i -r &amp;quot;s#(image: )(.*)#\\1$image_name#&amp;quot; ${current_dir}/${service}/${service}.yaml\nkubectl apply -f ${current_dir}/${service}/${service}.yaml\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;7-å®‰è£…k8s\&#34;&gt;&lt;strong&gt;7.  å®‰è£…K8S&lt;/strong&gt;&lt;/h2&gt;\n&#34;,&#34;fileName&#34;:&#34;2020-04-21k3s-cong-0-da-jian&#34;,&#34;abstract&#34;:&#34;&#34;,&#34;title&#34;:&#34;[2020-04-21]K3Sä»0æ­å»ºä»¥åŠé›†æˆJenkinsCICDæµç¨‹&#34;,&#34;tags&#34;:[],&#34;date&#34;:&#34;2020-04-21 21:24:00&#34;,&#34;dateFormat&#34;:&#34;2020-04-21&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://RookieYan.github.io/post/2020-04-21k3s-cong-0-da-jian/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;7 min read&#34;,&#34;time&#34;:394000,&#34;words&#34;:1327,&#34;minutes&#34;:7},&#34;description&#34;:&#34;0. å‡†å¤‡å·¥ä½œ\n\né¦–å…ˆå‡†å¤‡ä¸¤å°ECSï¼ˆæˆ‘ç”¨çš„æ˜¯é˜¿é‡Œäº‘çš„4æ ¸8Gï¼Œä¹°äº†ä¸€ä¸ªå‘¨ï¼Œå‡†å¤‡æä¸€ä¸‹ï¼‰\n\n1. ç¯å¢ƒé…ç½®\n\néœ€è¦Docker 19.03ï¼ˆå¦‚æœä½¿ç”¨è¾ƒä½ç‰ˆæœ¬ï¼Œåˆ™å¯èƒ½ä¼šå‡ºç°K3Sæ— æ³•å¯åŠ¨çš„é—®é¢˜ï¼‰\n\n\néœ€è¦æŠŠyum åŒ…æ›´æ–°åˆ°æœ€æ–°\n\nyum  u...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#0-%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C\&#34;&gt;&lt;strong&gt;0. å‡†å¤‡å·¥ä½œ&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#1-%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE\&#34;&gt;&lt;strong&gt;1. ç¯å¢ƒé…ç½®&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#2-%E5%AE%89%E8%A3%85k3smaster\&#34;&gt;&lt;strong&gt;2. å®‰è£…K3SMaster&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#3-node%E8%8A%82%E7%82%B9%E7%99%BB%E5%BD%95\&#34;&gt;&lt;strong&gt;3. NodeèŠ‚ç‚¹ç™»å½•&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#4-%E9%9C%80%E8%A6%81%E5%AE%89%E8%A3%85maven%E5%92%8Cgit%E5%90%8C%E6%97%B6%E6%8A%8A%E4%BB%A3%E7%A0%81pull%E4%B8%8B%E6%9D%A5\&#34;&gt;&lt;strong&gt;4.  éœ€è¦å®‰è£…mavenå’ŒGitåŒæ—¶æŠŠä»£ç pullä¸‹æ¥&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#5-%E5%AE%89%E8%A3%85harbor\&#34;&gt;&lt;strong&gt;5.  å®‰è£…harbor&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#6-%E7%BC%96%E5%86%99%E8%84%9A%E6%9C%AC%E6%96%87%E4%BB%B6maven%E6%89%93%E5%8C%85docker%E5%88%B6%E4%BD%9C%E9%95%9C%E5%83%8F%E4%BE%9D%E8%B5%96%E7%9A%84%E6%98%AF%E7%9B%AE%E5%BD%95%E4%B8%8B%E7%9A%84dockerfile\&#34;&gt;&lt;strong&gt;6.  ç¼–å†™è„šæœ¬æ–‡ä»¶ï¼Œmavenæ‰“åŒ…+dockeråˆ¶ä½œé•œåƒï¼ˆä¾èµ–çš„æ˜¯ç›®å½•ä¸‹çš„Dockerfileï¼‰&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#7-%E5%AE%89%E8%A3%85k8s\&#34;&gt;&lt;strong&gt;7.  å®‰è£…K8S&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;Â Â ä¹‹å‰çš„ç”±äºä¸å°å¿ƒæŠŠæ‰€æœ‰çš„åšå®¢éƒ½åˆ äº†ï¼Œæ‰€ä»¥ä»0å¼€å§‹é‡æ–°å†™å§ã€‚å› ä¸ºæœ€è¿‘åœ¨çœ‹MySQLå’ŒMongoDBç›¸å…³çš„ï¼Œè¿™ç¯‡å°±å…ˆä»MySQLå¼€å§‹äº†.. åç»­ä¼šç»§ç»­è¡¥ä¸ŠMongoDBçš„å†…å®¹..&lt;br&gt;\nÂ Â è¿™ç¯‡ä¸»è¦æ˜¯è®²ä¸€ä¸‹MySQLçš„åŸºç¡€.. åŒ…æ‹¬è¯­å¥çš„æ‰§è¡Œæµç¨‹..&lt;/p&gt;\n&lt;p&gt;&lt;img src=\&#34;https://RookieYan.github.io/post-images/1587222171337.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;br&gt;\nÂ Â é¦–å…ˆç®€å•ä»‹ç»ä¸€ä¸‹MySQLçš„åŸºç¡€ç»“æ„å›¾ï¼Œå¯ä»¥ä»è¿™å¼ å›¾æ¸…æ¥šçš„çœ‹å‡ºä¸€æ¡è¯­å¥åœ¨MySQLçš„å„ä¸ªåŠŸèƒ½æ¨¡å—ä¸­çš„æ‰§è¡Œè¿‡ç¨‹ã€‚&lt;br&gt;\nÂ Â å¤§ä½“æ¥è¯´MySQL å¯ä»¥åˆ†ä¸º&lt;strong&gt;Serverå±‚&lt;/strong&gt; å’Œ &lt;strong&gt;å­˜å‚¨å¼•æ“å±‚&lt;/strong&gt;ä¸¤éƒ¨åˆ†ã€‚&lt;br&gt;\nÂ Â Serverå±‚åŒ…å«äº†è¿æ¥å™¨ï¼Œåˆ†æå™¨ï¼Œä¼˜åŒ–å™¨ï¼Œæ‰§è¡Œå™¨ç­‰.. æ¶µç›–äº†å¤§éƒ¨åˆ†MySQLçš„æ ¸å¿ƒåŠŸèƒ½ï¼Œä¸€çº§æ‰€æœ‰çš„å†…ç½®å‡½æ•°ï¼ˆæ¯”å¦‚æ—¶é—´ï¼Œæ—¥æœŸï¼Œæ•°å­¦å’ŒåŠ å¯†å‡½æ•°ç­‰ï¼‰ï¼Œæ‰€æœ‰è·¨å­˜å‚¨å¼•æ“çš„åŠŸèƒ½éƒ½åœ¨è¿™ä¸€å±‚ä¸­ï¼Œæ¯”å¦‚å­˜å‚¨è¿‡ç¨‹ï¼Œè§¦å‘å™¨ï¼Œè§†å›¾ç­‰ç­‰..&lt;/p&gt;\n&lt;p&gt;Â Â å­˜å‚¨å¼•æ“å±‚åˆ™è´Ÿè´£æ•°æ®çš„å­˜å‚¨å’Œæå–ã€‚ä»–çš„æ¶æ„æ¨¡å¼æ˜¯æ’ä»¶å¼çš„ï¼Œæ”¯æŒå¤šç§ä¸åŒçš„æ•°æ®åº“å­˜å‚¨å¼•æ“ï¼Œæ¯”å¦‚InnoDBï¼ŒMyISAMï¼ŒMemoryç­‰.. ç°åœ¨æ¯”è¾ƒå¸¸ç”¨çš„æ˜¯InnoDBï¼Œåœ¨MySQL5.5.5å¼€å§‹æˆä¸ºäº†MySQLé»˜è®¤çš„å­˜å‚¨å¼•æ“ã€‚&lt;/p&gt;\n&lt;p&gt;Â Â ä¹Ÿå°±æ˜¯è¯´ä½ æ¯æ¬¡åœ¨åˆ›å»ºè¡¨çš„æ—¶å€™ï¼Œå¦‚æœä¸æŒ‡å®šå­˜å‚¨å¼•æ“ï¼Œå°±ä¼šé»˜è®¤ä½¿ç”¨InnoDBå­˜å‚¨å¼•æ“ã€‚å½“ç„¶ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ä½¿ç”¨åˆ«çš„å­˜å‚¨å¼•æ“ï¼Œæ¯”å¦‚åœ¨ create table è¯­å¥ä¸­ä½¿ç”¨ engine=memory æ¥æŒ‡å®šå­˜å‚¨å¼•æ“åˆ›å»ºè¡¨ã€‚&lt;strong&gt;ä¸åŒçš„å­˜å‚¨å¼•æ“å¯¹äºæ•°æ®çš„å­˜å–æ–¹å¼ä¹Ÿä¸ç›¸åŒï¼Œæ”¯æŒçš„åŠŸèƒ½ä¹Ÿä¸ç›¸åŒï¼Œåœ¨åé¢æˆ‘ä»¬ä¼šè¯´ä¸€ä¸‹å…³äºä¸åŒåœºæ™¯ä¸‹ä¸åŒå­˜å‚¨å¼•æ“çš„é€‰æ‹©ã€‚&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;æ¥ä¸‹æ¥ä»‹ç»ä¸€ä¸‹Serverå±‚çš„å„ä¸ªç»„ä»¶ã€‚&lt;/p&gt;\n&lt;h2 id=\&#34;è¿æ¥å™¨\&#34;&gt;&lt;strong&gt;è¿æ¥å™¨&lt;/strong&gt;&lt;/h2&gt;\n&lt;p&gt;Â Â æ¯æ¬¡æˆ‘ä»¬è¾“å…¥è´¦å·å¯†ç å’ŒMySQLè¦å»ºç«‹è¿æ¥çš„æ—¶å€™ï¼Œæ¥å¾…æˆ‘ä»¬çš„å°±æ˜¯&lt;strong&gt;è¿æ¥å™¨&lt;/strong&gt;ï¼Œä»–è´Ÿè´£è·Ÿå®¢æˆ·ç«¯å»ºç«‹è¿æ¥ï¼Œè·å–æƒé™ä¿¡æ¯ï¼Œç»´æŒå’Œç®¡ç†è¿æ¥ã€‚ä¸€èˆ¬çš„è¿æ¥å‘½ä»¤&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;mysql -h$ip -P$port -u$user -p\n&lt;/code&gt;&lt;/pre&gt;\n&lt;ul&gt;\n&lt;li&gt;å¦‚æœç”¨æˆ·åæˆ–å¯†ç ä¸å¯¹ï¼Œä½ å°±ä¼šæ”¶åˆ°ä¸€ä¸ª&amp;quot;Access denied for user&amp;quot;çš„é”™è¯¯ï¼Œç„¶åå®¢æˆ·ç«¯ç¨‹åºç»“æŸæ‰§è¡Œã€‚&lt;/li&gt;\n&lt;li&gt;å¦‚æœç”¨æˆ·åå¯†ç è®¤è¯é€šè¿‡ï¼Œè¿æ¥å™¨ä¼šåˆ°æƒé™è¡¨é‡Œé¢æŸ¥å‡ºä½ æ‹¥æœ‰çš„æƒé™ã€‚ä¹‹åï¼Œè¿™ä¸ªè¿æ¥é‡Œé¢çš„æƒé™åˆ¤æ–­é€»è¾‘ï¼Œéƒ½å°†ä¾èµ–äºæ­¤æ—¶è¯»åˆ°çš„æƒé™ã€‚&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre&gt;&lt;code&gt;è¿™æ ·ä¹Ÿå°±æ„å‘³ç€ï¼Œåªè¦ä¸€ä¸ªå®¢æˆ·é€šè¿‡è¿æ¥å™¨å»ºç«‹äº†ä¸MySQLçš„è¿æ¥ï¼Œ\nå†å»å¯¹è¿™ä¸ªå®¢æˆ·å¸å·è¿›è¡Œæƒé™ä¸Šçš„æ“ä½œï¼Œéƒ½ä¸ä¼šå³æ—¶ç”Ÿæ•ˆï¼Œ\nåªèƒ½ç­‰åˆ°è¿™æ¬¡è¿æ¥ç»“æŸï¼Œä¸‹æ¬¡å†å»ºç«‹è¿æ¥çš„æ—¶å€™æ‰ä¼šç”Ÿæ•ˆã€‚\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Â Â å¦‚æœå»ºç«‹å®Œè¿æ¥æ²¡æœ‰åç»­æ“ä½œçš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ªè¿æ¥å°±ä¼šå¤„äºç©ºé—²çš„çŠ¶æ€ï¼Œä½ å¯ä»¥åœ¨ show processlist å‘½ä»¤ä¸­çœ‹åˆ°å®ƒã€‚æ–‡æœ¬ä¸­è¿™ä¸ªå›¾æ˜¯ show processlist çš„ç»“æœï¼Œå…¶ä¸­çš„ Command åˆ—æ˜¾ç¤ºä¸ºâ€œSleepâ€çš„è¿™ä¸€è¡Œï¼Œå°±è¡¨ç¤ºç°åœ¨ç³»ç»Ÿé‡Œé¢æœ‰ä¸€ä¸ªç©ºé—²è¿æ¥ã€‚&lt;/p&gt;\n&lt;p&gt;&lt;img src=\&#34;https://RookieYan.github.io/post-images/1587223843571.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;br&gt;\nÂ Â å®¢æˆ·ç«¯å¦‚æœå¤ªé•¿æ—¶é—´æ²¡æœ‰åŠ¨é™ï¼Œè¿æ¥å™¨å°±ä¼šè‡ªåŠ¨æ–­å¼€å®ƒã€‚ è¿™ä¸ªå‚æ•°ä¸»è¦æ˜¯ç”±&lt;strong&gt;wait_timeout&lt;/strong&gt;æ§åˆ¶çš„ï¼Œé»˜è®¤å€¼æ˜¯ 8 å°æ—¶ã€‚&lt;br&gt;\nÂ Â è€Œå¦‚æœæ°å¥½åœ¨è¿æ¥æ–­å¼€ä¹‹åï¼Œå®¢æˆ·ç«¯å†æ¬¡å‘é€è¯·æ±‚çš„è¯ï¼Œå°±ä¼šæ”¶åˆ°é”™è¯¯æé†’ Lost connection to MySQL server during queryã€‚è¿™æ—¶å€™å¦‚æœä½ è¦ç»§ç»­ï¼Œå°±éœ€è¦é‡è¿ï¼Œç„¶åå†æ‰§è¡Œè¯·æ±‚äº†ã€‚&lt;/p&gt;\n&lt;p&gt;Â Â  åœ¨æ•°æ®åº“ä¸­ï¼Œå®¢æˆ·ç«¯ä¸æ•°æ®åº“å»ºç«‹è¿æ¥çš„è¿‡ç¨‹æ˜¯ååˆ†å¤æ‚ä¸”æ¶ˆè€—èµ„æºçš„ï¼Œæ‰€ä»¥å»ºè®®ä½¿ç”¨é•¿é“¾æ¥ï¼ˆ&lt;strong&gt;é•¿é“¾æ¥æ˜¯æŒ‡å¦‚æœåœ¨å®¢æˆ·ç«¯ä¸æ•°æ®åº“è¿æ¥æˆåŠŸåï¼Œå¦‚æœå®¢æˆ·ç«¯æŒç»­æœ‰è¯·æ±‚è¿›æ¥ï¼Œé‚£ä¹ˆä¼šç»§ç»­ä½¿ç”¨å½“å‰å·²ç»å»ºç«‹å¥½çš„è¿™ä¸ªè¿æ¥ã€‚ è€ŒçŸ­è¿æ¥ä¸»è¦æ˜¯æŒ‡ï¼Œåœ¨æ¯æ¬¡æ‰§è¡Œå®Œå¾ˆå°‘çš„å‡ æ¬¡æ“ä½œåï¼Œå°±è‡ªåŠ¨æ–­å¼€è¿æ¥ï¼Œå¦‚æœå†æœ‰æ–°çš„è¯·æ±‚ï¼Œå°±é‡æ–°å»ºç«‹è¿æ¥ã€‚ è¿™æ ·æ¯”è¾ƒæ¶ˆè€—èµ„æº&lt;/strong&gt;ï¼‰ï¼Œ ä½†æ˜¯å¦‚æœå…¨éƒ¨ä½¿ç”¨é•¿è¿æ¥ä¹‹åä¼šå‘ç°æ•°æ®åº“å†…å­˜å ç”¨ä¼šæ¶¨çš„é£å¿«ï¼Œè¿™æ˜¯å› ä¸ºMySQLåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œä¸´æ—¶ä½¿ç”¨çš„å†…å­˜æ˜¯ç®¡ç†åœ¨è¿æ¥å¯¹è±¡é‡Œé¢çš„ã€‚è¿™äº›èµ„æºä¼šåœ¨è¿æ¥æ–­å¼€çš„æ—¶å€™æ‰ä¼šé‡Šæ”¾ã€‚æ‰€ä»¥é•¿è¿æ¥ç§¯ç´¯ä¸‹æ¥å°±ä¼šå¯¼è‡´å†…å­˜å ç”¨ç‡ç‰¹åˆ«é«˜ï¼Œè¢«ç³»ç»Ÿå¼ºè¡Œå¹²æ‰ï¼ˆOOMï¼‰ï¼Œä»ç°è±¡ä¸Šçœ‹å°±åƒæ˜¯MySQLå¼‚å¸¸é‡å¯äº†ã€‚&lt;/p&gt;\n&lt;p&gt;æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿä½ å¯ä»¥è€ƒè™‘ä»¥ä¸‹ä¸¤ç§æ–¹æ¡ˆã€‚&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;å®šæœŸæ–­å¼€é•¿è¿æ¥ã€‚ä½¿ç”¨ä¸€æ®µæ—¶é—´ï¼Œæˆ–è€…ç¨‹åºé‡Œé¢åˆ¤æ–­æ‰§è¡Œè¿‡ä¸€ä¸ªå ç”¨å†…å­˜çš„å¤§æŸ¥è¯¢åï¼Œæ–­å¼€è¿æ¥ï¼Œä¹‹åè¦æŸ¥è¯¢å†é‡è¿ã€‚&lt;/li&gt;\n&lt;li&gt;å¦‚æœä½ ç”¨çš„æ˜¯ MySQL 5.7 æˆ–æ›´æ–°ç‰ˆæœ¬ï¼Œå¯ä»¥åœ¨æ¯æ¬¡æ‰§è¡Œä¸€ä¸ªæ¯”è¾ƒå¤§çš„æ“ä½œåï¼Œé€šè¿‡æ‰§è¡Œ mysql_reset_connection æ¥é‡æ–°åˆå§‹åŒ–è¿æ¥èµ„æºã€‚è¿™ä¸ªè¿‡ç¨‹ä¸éœ€è¦é‡è¿å’Œé‡æ–°åšæƒé™éªŒè¯ï¼Œä½†æ˜¯ä¼šå°†è¿æ¥æ¢å¤åˆ°åˆšåˆšåˆ›å»ºå®Œæ—¶çš„çŠ¶æ€ã€‚&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&#34;æŸ¥è¯¢ç¼“å­˜\&#34;&gt;&lt;strong&gt;æŸ¥è¯¢ç¼“å­˜&lt;/strong&gt;&lt;/h2&gt;\n&lt;p&gt;Â Â  åœ¨é€šè¿‡è¿æ¥å™¨åˆ›å»ºå®Œè¿æ¥ä¹‹åï¼Œå°±è¦æ‰§è¡ŒSQLå‘½ä»¤äº†ï¼Œæ¯”å¦‚ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ï¼Œè¿™ä¸ªæ—¶å€™æ‰§è¡Œé€»è¾‘å°±ä¼šæ¥åˆ°ç¬¬äºŒæ­¥ï¼ŒæŸ¥è¯¢ç¼“å­˜ã€‚&lt;/p&gt;\n&lt;p&gt;Â Â  MySQLæ‹¿åˆ°ä¸€ä¸ªæŸ¥è¯¢è¯·æ±‚åï¼Œä¼šå…ˆåˆ°æŸ¥è¯¢ç¼“å­˜çœ‹ä¸€ä¸‹ï¼Œä¹‹å‰æ˜¯å¦æ‰§è¡Œè¿‡è¿™æ¡è¯­å¥ã€‚ ä¹‹å‰æŸ¥è¯¢è¿‡çš„ä¼šä»¥key-valueå¯¹çš„å½¢å¼ï¼Œè¢«ç›´æ¥ç¼“å­˜åœ¨å†…å­˜ä¸­ã€‚keyæ˜¯æŸ¥è¯¢è¯­å¥ï¼Œvalueæ˜¯æŸ¥è¯¢ç»“æœã€‚ å¦‚æœèƒ½å¤Ÿåœ¨ç¼“å­˜ä¸­æ‰¾åˆ°è¿™ä¸ªkeyï¼Œé‚£ä¹ˆè¿™ä¸ªvalueå°±ä¼šç›´æ¥è¿”å›ç»™å®¢æˆ·ç«¯ã€‚&lt;/p&gt;\n&lt;p&gt;Â Â  å¦‚æœè¯­å¥ä¸åœ¨æŸ¥è¯¢ç¼“å­˜ä¸­ï¼Œå°±ä¼šç»§ç»­åé¢çš„æ‰§è¡Œé˜¶æ®µï¼Œè¿›è¡ŒæŸ¥è¯¢ã€‚æŸ¥è¯¢å®Œæˆåæ‰§è¡Œç»“æœå°±ä¼šè¢«å­˜å‚¨åˆ°æŸ¥è¯¢ç¼“å­˜ä¸­ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœå‘½ä¸­æŸ¥è¯¢ç¼“å­˜ï¼ŒMySQLä¸éœ€è¦æ‰§è¡Œåé¢çš„å¤æ‚æ“ä½œï¼Œå°±å¯ä»¥ç›´æ¥è¿”å›ç»“æœï¼Œè¿™ä¸ªæ•ˆç‡ä¼šå¾ˆé«˜ã€‚&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;ä½†æ˜¯åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ˜¯ä¸å»ºè®®ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜çš„ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºæŸ¥è¯¢ç¼“å­˜ç½‘å¾€å¼Šå¤§äºåˆ©ã€‚&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Â Â  ä¸»è¦åŸå› æ˜¯å› ä¸ºæŸ¥è¯¢ç¼“å­˜å¤±æ•ˆçš„æ¦‚ç‡éå¸¸å¤§ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºæ¯æ¬¡åªè¦å¯¹æŸä¸€å¼ è¡¨æœ‰æ›´æ–°æ“ä½œï¼Œè¿™ä¸ªè¡¨ä¸Šæ‰€æœ‰çš„æŸ¥è¯¢ç¼“å­˜éƒ½ä¼šè¢«æ¸…ç©ºã€‚ å› æ­¤å¯èƒ½ä½ è´¹åŠ²æŠŠç»“æœå­˜èµ·æ¥ä¹‹åï¼Œè¿˜æ²¡æœ‰ç”¨å‘¢ï¼Œä¸€ä¸ªæ›´æ–°è¯­å¥å°±æŠŠç¼“å­˜æ¸…ç©ºäº†ã€‚è¿™æ ·å¯¹äºæ›´æ–°æ“ä½œæ¯”è¾ƒé¢‘ç¹çš„æ•°æ®åº“æ¥è¯´ï¼ŒæŸ¥è¯¢ç¼“å­˜çš„å‘½ä¸­ç‡ä¼šéå¸¸ä½ã€‚é™¤éæ˜¯ä¸€å¼ é™æ€çš„lookUpè¡¨ï¼Œå¾ˆé•¿æ—¶é—´æ‰ä¼šæ›´æ–°ä¸€æ¬¡ã€‚æ¯”å¦‚ç³»ç»Ÿé…ç½®è¡¨ï¼Œè¡Œæ”¿åŒºåˆ’è¡¨ç­‰è¡¨ä¸Šçš„æŸ¥è¯¢æ‰ä¼šæ¯”è¾ƒé€‚åˆä½¿ç”¨æŸ¥è¯¢ç¼“å­˜ã€‚&lt;br&gt;\nÂ Â  å¥½åœ¨MySQLä¹Ÿæä¾›è¿™ç§â€œæŒ‰éœ€ä½¿ç”¨â€çš„æ–¹å¼ï¼Œä½ å¯ä»¥å°†å‚æ•°query_cache_typeè®¾ç½®ä¸ºDEMANDï¼Œè¿™æ ·å¯¹äºé»˜è®¤çš„SQLè¯­å¥éƒ½ä¸ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜ã€‚ è€Œå¯¹äºä½ ç¡®å®šè¦ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜çš„è¯­å¥å¯ä»¥ç”¨SQL_CACHE æ˜¾å¼æŒ‡å®šï¼Œåƒä¸‹é¢è¿™ä¸ªè¯­å¥ä¸€æ ·ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;select SQL_CACHE * from T where ID=10ï¼›\n&lt;/code&gt;&lt;/pre&gt;\n&lt;ul&gt;\n&lt;li&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒMySQL8.0ç‰ˆæœ¬å·²ç»ç›´æ¥åˆ é™¤äº†æŸ¥è¯¢ç¼“å­˜åŠŸèƒ½ã€‚&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&#34;åˆ†æå™¨\&#34;&gt;&lt;strong&gt;åˆ†æå™¨&lt;/strong&gt;&lt;/h2&gt;\n&lt;p&gt;Â Â å¦‚æœæ²¡æœ‰å‘½ä¸­æŸ¥è¯¢ç¼“å­˜ï¼Œå°±è¦å¼€å§‹çœŸæ­£æ‰§è¡ŒSQLè¯­å¥äº†ï¼Œé¦–å…ˆMySQLéœ€è¦çŸ¥é“ä½ è¦åšä»€ä¹ˆï¼Œå› æ­¤éœ€è¦å¯¹MySQLè¯­å¥åšè§£æã€‚&lt;br&gt;\nÂ Â åˆ†æå™¨ä¼šç°åšâ€œè¯æ³•è§£æâ€ï¼Œä½ è¾“å…¥çš„æ˜¯ç”±å¤šä¸ªå­—ç¬¦ä¸²å’Œç©ºæ ¼ç»„æˆçš„ä¸€æ¡SQLè¯­å¥ï¼ŒMySQLéœ€è¦è¯†åˆ«å‡ºé‡Œé¢çš„å­—ç¬¦ä¸²åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Œä»£è¡¨ä»€ä¹ˆã€‚&lt;/p&gt;\n&lt;p&gt;Â Â MySQL ä»ä½ è¾“å…¥çš„&amp;quot;select&amp;quot;è¿™ä¸ªå…³é”®å­—è¯†åˆ«å‡ºæ¥ï¼Œè¿™æ˜¯ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ã€‚å®ƒä¹Ÿè¦æŠŠå­—ç¬¦ä¸²â€œTâ€è¯†åˆ«æˆâ€œè¡¨å Tâ€ï¼ŒæŠŠå­—ç¬¦ä¸²â€œIDâ€è¯†åˆ«æˆâ€œåˆ— IDâ€ã€‚&lt;br&gt;\nÂ Â åšå®Œäº†è¿™äº›è¯†åˆ«ä»¥åï¼Œå°±è¦åšâ€œè¯­æ³•åˆ†æâ€ã€‚æ ¹æ®è¯æ³•åˆ†æçš„ç»“æœï¼Œè¯­æ³•åˆ†æå™¨ä¼šæ ¹æ®è¯­æ³•è§„åˆ™ï¼Œåˆ¤æ–­ä½ è¾“å…¥çš„è¿™ä¸ª SQL è¯­å¥æ˜¯å¦æ»¡è¶³ MySQL è¯­æ³•ã€‚&lt;br&gt;\nÂ Â å¦‚æœä½ çš„è¯­å¥ä¸å¯¹ï¼Œå°±ä¼šæ”¶åˆ°â€œYou have an error in your SQL syntaxâ€çš„é”™è¯¯æé†’ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªè¯­å¥ select å°‘æ‰“äº†å¼€å¤´çš„å­—æ¯â€œsâ€ã€‚&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;\nmysql&amp;gt; elect * from t where ID=1;\n\nERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;elect * from t where ID=1&#39; at line 1\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;ä¸€èˆ¬è¯­æ³•é”™è¯¯ä¼šæç¤ºç¬¬ä¸€ä¸ªå‡ºç°é”™è¯¯çš„ä½ç½®ï¼Œæ‰€ä»¥ä½ è¦å…³æ³¨çš„æ˜¯ç´§æ¥â€œuse nearâ€çš„å†…å®¹ã€‚&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;&lt;a href=\&#34;https://tech.meituan.com/2018/05/20/sql-parser-used-in-mtdp.html\&#34;&gt;è¯¦ç»†è¯­æ³•SQLè§£ææµç¨‹ï¼Œæ¥è‡ªç¾å›¢æŠ€æœ¯å›¢é˜Ÿï¼Œç‚¹å‡»è·³è½¬&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;\n&lt;h2 id=\&#34;ä¼˜åŒ–å™¨\&#34;&gt;&lt;strong&gt;ä¼˜åŒ–å™¨&lt;/strong&gt;&lt;/h2&gt;\n&lt;p&gt;Â Â ç»è¿‡äº†åˆ†æå™¨ï¼ŒMySQL å°±çŸ¥é“ä½ è¦åšä»€ä¹ˆäº†ã€‚åœ¨å¼€å§‹æ‰§è¡Œä¹‹å‰ï¼Œè¿˜è¦å…ˆç»è¿‡ä¼˜åŒ–å™¨çš„å¤„ç†ã€‚&lt;br&gt;\nÂ Â ä¼˜åŒ–å™¨æ˜¯åœ¨è¡¨é‡Œé¢æœ‰å¤šä¸ªç´¢å¼•çš„æ—¶å€™ï¼Œå†³å®šä½¿ç”¨å“ªä¸ªç´¢å¼•ï¼›æˆ–è€…åœ¨ä¸€ä¸ªè¯­å¥æœ‰å¤šè¡¨å…³è”ï¼ˆjoinï¼‰çš„æ—¶å€™ï¼Œå†³å®šå„ä¸ªè¡¨çš„è¿æ¥é¡ºåºã€‚æ¯”å¦‚ä½ æ‰§è¡Œä¸‹é¢è¿™æ ·çš„è¯­å¥ï¼Œè¿™ä¸ªè¯­å¥æ˜¯æ‰§è¡Œä¸¤ä¸ªè¡¨çš„ joinï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;mysql&amp;gt; select * from t1 join t2 using(ID) where t1.c=10 and t2.d=20;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;ul&gt;\n&lt;li&gt;æ—¢å¯ä»¥å…ˆä»è¡¨ t1 é‡Œé¢å–å‡º c=10 çš„è®°å½•çš„ ID å€¼ï¼Œå†æ ¹æ® ID å€¼å…³è”åˆ°è¡¨ t2ï¼Œå†åˆ¤æ–­ t2 é‡Œé¢ d çš„å€¼æ˜¯å¦ç­‰äº 20ã€‚&lt;/li&gt;\n&lt;li&gt;ä¹Ÿå¯ä»¥å…ˆä»è¡¨ t2 é‡Œé¢å–å‡º d=20 çš„è®°å½•çš„ ID å€¼ï¼Œå†æ ¹æ® ID å€¼å…³è”åˆ° t1ï¼Œå†åˆ¤æ–­ t1 é‡Œé¢ c çš„å€¼æ˜¯å¦ç­‰äº 10ã€‚&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;ä¼˜åŒ–å™¨é˜¶æ®µå®Œæˆåï¼Œè¿™ä¸ªè¯­å¥çš„æ‰§è¡Œæ–¹æ¡ˆå°±ç¡®å®šä¸‹æ¥äº†ï¼Œç„¶åè¿›å…¥æ‰§è¡Œå™¨é˜¶æ®µã€‚å¦‚æœä½ è¿˜æœ‰ä¸€äº›ç–‘é—®ï¼Œæ¯”å¦‚ä¼˜åŒ–å™¨æ˜¯æ€ä¹ˆé€‰æ‹©ç´¢å¼•çš„ï¼Œæœ‰æ²¡æœ‰å¯èƒ½é€‰æ‹©é”™ç­‰ç­‰ï¼Œæˆ‘ä¼šåœ¨åé¢çš„åšå®¢ä¸­å•ç‹¬å±•å¼€è¯´æ˜ä¼˜åŒ–å™¨çš„å†…å®¹ã€‚&lt;/p&gt;\n&lt;h2 id=\&#34;æ‰§è¡Œå™¨\&#34;&gt;&lt;strong&gt;æ‰§è¡Œå™¨&lt;/strong&gt;&lt;/h2&gt;\n&lt;p&gt;Â Â MySQL é€šè¿‡åˆ†æå™¨çŸ¥é“äº†ä½ è¦åšä»€ä¹ˆï¼Œé€šè¿‡ä¼˜åŒ–å™¨çŸ¥é“äº†è¯¥æ€ä¹ˆåšï¼Œäºæ˜¯å°±è¿›å…¥äº†æ‰§è¡Œå™¨é˜¶æ®µï¼Œå¼€å§‹æ‰§è¡Œè¯­å¥ã€‚&lt;br&gt;\nÂ Â å¼€å§‹æ‰§è¡Œçš„æ—¶å€™ï¼Œè¦å…ˆåˆ¤æ–­ä¸€ä¸‹ä½ å¯¹è¿™ä¸ªè¡¨ T æœ‰æ²¡æœ‰æ‰§è¡ŒæŸ¥è¯¢çš„æƒé™ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±ä¼šè¿”å›æ²¡æœ‰æƒé™çš„é”™è¯¯ï¼Œå¦‚ä¸‹æ‰€ç¤º (åœ¨å·¥ç¨‹å®ç°ä¸Šï¼Œå¦‚æœå‘½ä¸­æŸ¥è¯¢ç¼“å­˜ï¼Œä¼šåœ¨æŸ¥è¯¢ç¼“å­˜è¿”å›ç»“æœçš„æ—¶å€™ï¼Œåšæƒé™éªŒè¯ã€‚æŸ¥è¯¢ä¹Ÿä¼šåœ¨ä¼˜åŒ–å™¨ä¹‹å‰è°ƒç”¨ precheck éªŒè¯æƒé™)ã€‚&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;mysql&amp;gt; select * from T where ID=10;ERROR 1142 (42000): SELECT command denied to user &#39;b&#39;@&#39;localhost&#39; for table &#39;T&#39;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Â Â å¦‚æœæœ‰æƒé™ï¼Œå°±æ‰“å¼€è¡¨ç»§ç»­æ‰§è¡Œã€‚æ‰“å¼€è¡¨çš„æ—¶å€™ï¼Œæ‰§è¡Œå™¨å°±ä¼šæ ¹æ®è¡¨çš„å¼•æ“å®šä¹‰ï¼Œå»ä½¿ç”¨è¿™ä¸ªå¼•æ“æä¾›çš„æ¥å£ã€‚&lt;br&gt;\nÂ Â æ¯”å¦‚æˆ‘ä»¬è¿™ä¸ªä¾‹å­ä¸­çš„è¡¨ T ä¸­ï¼ŒID å­—æ®µæ²¡æœ‰ç´¢å¼•ï¼Œé‚£ä¹ˆæ‰§è¡Œå™¨çš„æ‰§è¡Œæµç¨‹æ˜¯è¿™æ ·çš„ï¼š&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;è°ƒç”¨ InnoDB å¼•æ“æ¥å£å–è¿™ä¸ªè¡¨çš„ç¬¬ä¸€è¡Œï¼Œåˆ¤æ–­ ID å€¼æ˜¯ä¸æ˜¯ 10ï¼Œå¦‚æœä¸æ˜¯åˆ™è·³è¿‡ï¼Œå¦‚æœæ˜¯åˆ™å°†è¿™è¡Œå­˜åœ¨ç»“æœé›†ä¸­ï¼›&lt;/li&gt;\n&lt;li&gt;è°ƒç”¨å¼•æ“æ¥å£å–â€œä¸‹ä¸€è¡Œâ€ï¼Œé‡å¤ç›¸åŒçš„åˆ¤æ–­é€»è¾‘ï¼Œç›´åˆ°å–åˆ°è¿™ä¸ªè¡¨çš„æœ€åä¸€è¡Œã€‚&lt;/li&gt;\n&lt;li&gt;æ‰§è¡Œå™¨å°†ä¸Šè¿°éå†è¿‡ç¨‹ä¸­æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„è¡Œç»„æˆçš„è®°å½•é›†ä½œä¸ºç»“æœé›†è¿”å›ç»™å®¢æˆ·ç«¯ã€‚&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;Â Â è‡³æ­¤ï¼Œè¿™ä¸ªè¯­å¥å°±æ‰§è¡Œå®Œæˆäº†ã€‚å¯¹äºæœ‰ç´¢å¼•çš„è¡¨ï¼Œæ‰§è¡Œçš„é€»è¾‘ä¹Ÿå·®ä¸å¤šã€‚ç¬¬ä¸€æ¬¡è°ƒç”¨çš„æ˜¯â€œå–æ»¡è¶³æ¡ä»¶çš„ç¬¬ä¸€è¡Œâ€è¿™ä¸ªæ¥å£ï¼Œä¹‹åå¾ªç¯å–â€œæ»¡è¶³æ¡ä»¶çš„ä¸‹ä¸€è¡Œâ€è¿™ä¸ªæ¥å£ï¼Œè¿™äº›æ¥å£éƒ½æ˜¯å¼•æ“ä¸­å·²ç»å®šä¹‰å¥½çš„ã€‚&lt;br&gt;\nÂ Â ä½ ä¼šåœ¨æ•°æ®åº“çš„æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­çœ‹åˆ°ä¸€ä¸ª rows_examined çš„å­—æ®µï¼Œè¡¨ç¤ºè¿™ä¸ªè¯­å¥æ‰§è¡Œè¿‡ç¨‹ä¸­æ‰«æäº†å¤šå°‘è¡Œã€‚è¿™ä¸ªå€¼å°±æ˜¯åœ¨æ‰§è¡Œå™¨æ¯æ¬¡è°ƒç”¨å¼•æ“è·å–æ•°æ®è¡Œçš„æ—¶å€™ç´¯åŠ çš„ã€‚&lt;br&gt;\nÂ Â åœ¨æœ‰äº›åœºæ™¯ä¸‹ï¼Œæ‰§è¡Œå™¨è°ƒç”¨ä¸€æ¬¡ï¼Œåœ¨å¼•æ“å†…éƒ¨åˆ™æ‰«æäº†å¤šè¡Œï¼Œå› æ­¤å¼•æ“æ‰«æè¡Œæ•°è·Ÿ rows_examined å¹¶ä¸æ˜¯å®Œå…¨ç›¸åŒçš„ã€‚æˆ‘ä»¬åé¢ä¼šä¸“é—¨æœ‰ä¸€ç¯‡æ–‡ç« æ¥è®²å­˜å‚¨å¼•æ“çš„å†…éƒ¨æœºåˆ¶ï¼Œé‡Œé¢ä¼šæœ‰è¯¦ç»†çš„è¯´æ˜ã€‚&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;2020-04-18mysqlyi-sql-de-zhi-xing-liu-cheng&#34;,&#34;abstract&#34;:&#34;&#34;,&#34;title&#34;:&#34;[2020-04-18]MySQLï¼ˆä¸€ï¼‰SQLçš„æ‰§è¡Œæµç¨‹&#34;,&#34;tags&#34;:[],&#34;date&#34;:&#34;2020-04-18 22:28:24&#34;,&#34;dateFormat&#34;:&#34;2020-04-18&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://RookieYan.github.io/post/2020-04-18mysqlyi-sql-de-zhi-xing-liu-cheng/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;11 min read&#34;,&#34;time&#34;:645000,&#34;words&#34;:3028,&#34;minutes&#34;:11},&#34;description&#34;:&#34;Â Â ä¹‹å‰çš„ç”±äºä¸å°å¿ƒæŠŠæ‰€æœ‰çš„åšå®¢éƒ½åˆ äº†ï¼Œæ‰€ä»¥ä»0å¼€å§‹é‡æ–°å†™å§ã€‚å› ä¸ºæœ€è¿‘åœ¨çœ‹MySQLå’ŒMongoDBç›¸å…³çš„ï¼Œè¿™ç¯‡å°±å…ˆä»MySQLå¼€å§‹äº†.. åç»­ä¼šç»§ç»­è¡¥ä¸ŠMongoDBçš„å†…å®¹..\nÂ Â è¿™ç¯‡ä¸»è¦æ˜¯è®²ä¸€ä¸‹MySQLçš„åŸºç¡€.. åŒ…æ‹¬è¯­å¥çš„æ‰§è¡Œæµç¨‹...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E8%BF%9E%E6%8E%A5%E5%99%A8\&#34;&gt;&lt;strong&gt;è¿æ¥å™¨&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%9F%A5%E8%AF%A2%E7%BC%93%E5%AD%98\&#34;&gt;&lt;strong&gt;æŸ¥è¯¢ç¼“å­˜&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%88%86%E6%9E%90%E5%99%A8\&#34;&gt;&lt;strong&gt;åˆ†æå™¨&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E4%BC%98%E5%8C%96%E5%99%A8\&#34;&gt;&lt;strong&gt;ä¼˜åŒ–å™¨&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%89%A7%E8%A1%8C%E5%99%A8\&#34;&gt;&lt;strong&gt;æ‰§è¡Œå™¨&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;Â Â ä¹‹å‰å› ä¸ºæ­äº†ä¸€ä¸ªNgrokï¼Œè¢«é»‘å®¢æ‰«åˆ°äº†ï¼ŒæŠŠç”µè„‘é»‘äº†ã€‚ç„¶åä»Šå¤©é‡è£…äº†ç³»ç»Ÿï¼Œæ ¼å¼åŒ–äº†ç¡¬ç›˜ï¼Œä¸€ä¸å°å¿ƒæŠŠåšå®¢ä¹Ÿéƒ½æ¸…äº†... æ²¡åŠæ³•...  å›ä¸å»çš„å°±ç•™åœ¨è¿‡å»å§...  é‡æ–°å†™....&lt;/p&gt;\n&lt;p&gt;Â Â åŠ æ²¹...&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;2020-04-11chong-xin-kai-shi&#34;,&#34;abstract&#34;:&#34;&#34;,&#34;title&#34;:&#34;[2020-04-11]é‡æ–°å¼€å§‹&#34;,&#34;tags&#34;:[],&#34;date&#34;:&#34;2020-04-11 22:49:04&#34;,&#34;dateFormat&#34;:&#34;2020-04-11&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://RookieYan.github.io/post/2020-04-11chong-xin-kai-shi/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;1 min read&#34;,&#34;time&#34;:12000,&#34;words&#34;:64,&#34;minutes&#34;:1},&#34;description&#34;:&#34;Â Â ä¹‹å‰å› ä¸ºæ­äº†ä¸€ä¸ªNgrokï¼Œè¢«é»‘å®¢æ‰«åˆ°äº†ï¼ŒæŠŠç”µè„‘é»‘äº†ã€‚ç„¶åä»Šå¤©é‡è£…äº†ç³»ç»Ÿï¼Œæ ¼å¼åŒ–äº†ç¡¬ç›˜ï¼Œä¸€ä¸å°å¿ƒæŠŠåšå®¢ä¹Ÿéƒ½æ¸…äº†... æ²¡åŠæ³•...  å›ä¸å»çš„å°±ç•™åœ¨è¿‡å»å§...  é‡æ–°å†™....\nÂ Â åŠ æ²¹...\n&#34;,&#34;toc&#34;:&#34;&#34;}]";
  // var json = escape.substr(1, escape.length - 2);
  // var datas = json.split(',');
  // for (let i=0; i < datas.length; i++) {
  //   let item = datas[i];
  //   let attrs = item.split('34;:&#34')
  //   debugger
  //   console.log(datas[i])
  // }
  let escapeMap = new Map();
  escapeMap.set('&#34;', '"');
  escapeMap.set('&gt;', '>');
  escapeMap.set('&#39;', "'");
  escapeMap.set('&lt;', '<');
  escapeMap.set('&quot;', '"');
  escapeMap.set('&amp;', '&');
</script> -->

<script src="/media/js/mouse/peace.js"></script>



</html>